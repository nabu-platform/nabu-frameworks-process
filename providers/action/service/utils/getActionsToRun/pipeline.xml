<structure name="pipeline">
    <structure name="input">
        <structure definition="be.nabu.libs.authentication.api.Token" minOccurs="0" name="token"/>
        <structure definition="be.nabu.libs.authentication.api.Device" minOccurs="0" name="device"/>
        <field comment="You can pass in a custom correlation id, this can be useful for example for asynchronous tasks that have still be bound correctly" minOccurs="0" name="correlationId" type="java.lang.String"/>
        <field minOccurs="0" name="sessionId" type="java.lang.String"/>
        <field minOccurs="0" name="serviceId" type="java.lang.String"/>
        <structure definition="java.lang.Object" minOccurs="0" name="serviceInput"/>
    </structure>
    <structure name="output">
        <structure definition="nabu.frameworks.process.providers.action.service.utils.actionToRun" maxOccurs="unbounded" minOccurs="0" name="actionsToRun"/>
    </structure>
    <field maxOccurs="unbounded" minOccurs="0" name="processStates" type="java.lang.String"/>
    <structure collectionName="processInstances" definition="nabu.frameworks.process.crud.processInstance.types.output" maxOccurs="unbounded" minOccurs="0" name="runningProcesses"/>
    <structure collectionName="processData" definition="nabu.frameworks.process.crud.processData.types.output" maxOccurs="unbounded" minOccurs="0" name="matchingDataForProcess"/>
    <structure collectionName="processActionInstances" definition="nabu.frameworks.process.crud.processActionInstance.types.output" maxOccurs="unbounded" minOccurs="0" name="relatedActionInstances"/>
    <structure collectionName="processActionRelations" comment="An action can be linked to one or more parent actions.&#10;It can only be executed if all the parent actions have been completed.&#10;This means for multiple parents a &quot;join&quot; in BPMN terminology&#10;&#10;Note that you can also have an inverse relationship, this means the target action must NOT have been executed yet.&#10;&#10;For instance on a particular action you want the user to do something and have an offshoot (with delay) of a reminder mail.&#10;The reminder mail must only trigger if the user has not taken action yet.&#10;This means the reminder mail has an inverse relationship to the user action" definition="nabu.frameworks.process.database.types.processActionRelation" maxOccurs="unbounded" minOccurs="0" name="incomingFlows"/>
    <structure collectionName="processActionRelations" comment="An action can be linked to one or more parent actions.&#10;It can only be executed if all the parent actions have been completed.&#10;This means for multiple parents a &quot;join&quot; in BPMN terminology&#10;&#10;Note that you can also have an inverse relationship, this means the target action must NOT have been executed yet.&#10;&#10;For instance on a particular action you want the user to do something and have an offshoot (with delay) of a reminder mail.&#10;The reminder mail must only trigger if the user has not taken action yet.&#10;This means the reminder mail has an inverse relationship to the user action" definition="nabu.frameworks.process.database.types.processActionRelation" maxOccurs="unbounded" minOccurs="0" name="outgoingFlows"/>
    <structure collectionName="processActionInstances" definition="nabu.frameworks.process.crud.processActionInstance.types.output" maxOccurs="unbounded" minOccurs="0" name="runIncomingActions"/>
    <structure collectionName="processActionInstances" definition="nabu.frameworks.process.crud.processActionInstance.types.output" maxOccurs="unbounded" minOccurs="0" name="finishedOutgoingActions"/>
    <field minOccurs="0" name="amountOfTimesRun" type="java.lang.Integer"/>
    <field minOccurs="0" name="amountOfIdentifiers" type="java.lang.Integer"/>
    <field minOccurs="0" name="amountOfDataMatches" type="java.lang.Integer"/>
    <field comment="If we want to start a new process, this is the id. We can already start referencing it" minOccurs="0" name="newProcessInstanceId" pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}" type="java.util.UUID"/>
    <field maxOccurs="unbounded" minOccurs="0" name="actionStates" type="java.lang.String"/>
    <structure collectionName="processData" definition="nabu.frameworks.process.crud.processData.types.output" minOccurs="0" name="processInstance"/>
    <structure definition="nabu.frameworks.process.providers.action.service.utils.groupedAction" maxOccurs="unbounded" minOccurs="0" name="potentialProcesses"/>
    <structure definition="nabu.frameworks.process.providers.action.service.utils.action" minOccurs="0" name="processActionToRun"/>
    <field comment="The way to capture it (e.g. the path). This is relative to the pipeline so should start with input or output. For blox services the full pipeline is available, for the rest only input/output." maxOccurs="unbounded" minOccurs="0" name="identifierValues" type="java.lang.String"/>
    <field comment="Defaults are: correlationId, userId, deviceId, sessionId, custom. Once custom you need to set up captures." maxOccurs="unbounded" minOccurs="0" name="identificationTypes" type="java.lang.String"/>
    <structure comment="The actions that match with the current state of the process" definition="nabu.frameworks.process.providers.action.service.utils.action" maxOccurs="unbounded" minOccurs="0" name="matchingActions"/>
    <structure definition="nabu.frameworks.process.providers.action.service.utils.capturedValue" maxOccurs="unbounded" name="allCaptures"/>
    <field comment="The way to capture it (e.g. the path). This is relative to the pipeline so should start with input or output. For blox services the full pipeline is available, for the rest only input/output." maxOccurs="unbounded" minOccurs="0" name="capturesToUse" type="java.lang.String"/>
    <structure collectionName="processData" definition="nabu.frameworks.process.crud.processData.types.output" maxOccurs="unbounded" minOccurs="0" name="matchingDataForAction"/>
    <structure definition="nabu.utils.types.Property" maxOccurs="unbounded" minOccurs="0" name="identifiers"/>
    <field minOccurs="0" name="amountOfProcessInstances" type="java.lang.Integer"/>
    <structure collectionName="processData" definition="nabu.frameworks.process.crud.processData.types.output" name="potentialProcessInstance"/>
    <field name="allowedToProceed" type="java.lang.Boolean"/>
    <field minOccurs="0" name="amountOfMatchingActions" type="java.lang.Integer"/>
    <structure definition="nabu.frameworks.process.providers.action.service.utils.action" maxOccurs="unbounded" minOccurs="0" name="actionsInInitialState"/>
    <structure definition="nabu.frameworks.process.providers.action.service.utils.action" maxOccurs="unbounded" minOccurs="0" name="triggerActions"/>
    <field minOccurs="0" name="amountOfTriggerActions" type="java.lang.Integer"/>
</structure>
