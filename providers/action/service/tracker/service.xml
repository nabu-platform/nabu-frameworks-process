<sequence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		disabled="false"
		id="8b3b282fff3840bfbd476165d9b65c81"
		lineNumber="1">
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			comment="Context based on current service"
			disabled="true"
			id="8adce1d6637f4ade83ba8296568980eb"
			lineNumber="2">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="1493b7b7f64d4057a16ab570d001eaee"
				serviceId="nabu.protocols.jdbc.pool.Services.connectionForContext"
				resultName="resultbe1a6154ad474e8b82d10448aa639a50"
				temporaryMapping="true"
				x="406"
				y="116"
				invocationOrder="0"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="c41e97c41e4a453a95b943d976f2bec4"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/name</from>
				<to>context</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="0c8cd2de1afa47ee90af0c005e24a016"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>resultbe1a6154ad474e8b82d10448aa639a50/connectionId</from>
			<to>serviceContextConnectionId</to>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="6819119bc3874243873790968179a680"
				serviceId="nabu.utils.reflection.Node.dependencies"
				resultName="result93efca2508ae41bba43d670fb690c06b"
				temporaryMapping="true"
				x="184"
				y="235"
				invocationOrder="0"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="d160be4694514eba896c5bed5fce9c5c"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>nabu.frameworks.process.database.model</from>
				<to>id</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="5d2facd25be245d3ad6fd7db68e1e1c2"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>result93efca2508ae41bba43d670fb690c06b/nodes[artifactClass == "be.nabu.eai.module.jdbc.pool.JDBCPoolArtifact"]/id</from>
			<to>synchronizedConnections</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			comment="Connection resolving, check framework documentation"
			disabled="false"
			id="36b39012e8c14f2085d5863f5e369010"
			lineNumber="3">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="be15004368d64c04936cc33960f9a290"
				serviceId="nabu.protocols.jdbc.pool.Services.connectionForContext"
				resultName="resultbe1a6154ad474e8b82d10448aa639a50"
				temporaryMapping="true"
				x="111"
				y="82"
				invocationOrder="1"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="dd93f30b3fad4fcb98abd6af00470986"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>nabu.frameworks.process</from>
				<to>context</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="bd86c7610def4c48bf286361d18b1ff2"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>nabu.frameworks.process.database.model</from>
				<to>requiredDependencies[0]</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="870d05388d594f50a74639f09e9cbf19"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>resultbe1a6154ad474e8b82d10448aa639a50/connectionId</from>
			<to>serviceContextConnectionId</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
			comment="Only continue if the current connection supports the process engine."
			disabled="false"
			id="98caa3cef5714cdc85f71c0d5b3486c8"
			label="serviceContextConnectionId != null"
			lineNumber="4"
			query="input/type">
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
				disabled="false"
				id="c3665a4710b14977b359eadf2327cd28"
				label="&quot;SERVICE&quot;"
				lineNumber="5">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map"
					disabled="false"
					id="11c925a58af74fc59ed18e89efa0c2ed"
					lineNumber="6">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
						disabled="false"
						id="b005e3aaa2c348fea076d4e533f7fe47"
						serviceId="nabu.utils.Transaction.defaultTransactionId"
						resultName="result94d04ea206bf46df83c3b040cb8664af"
						temporaryMapping="true"
						x="89"
						y="88"
						invocationOrder="0"
						asynchronous="false"
						recache="false">
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="8234cf8ea7564a968c43ea9f08d154a7"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>result94d04ea206bf46df83c3b040cb8664af/transactionId</from>
					<to>defaultTransactionId</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
						disabled="false"
						id="9d41d6289eb8441e87083413f0611860"
						serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.registerFailure"
						resultName="resultbf17a47f9b2c4cc28067d4946fc64281"
						temporaryMapping="true"
						x="200"
						y="180"
						invocationOrder="1"
						asynchronous="false"
						recache="false">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="c375def8abc34abdbf4260c0a98f6c32"
							mask="false"
							optional="false"
							fixedValue="false">
						<from>result94d04ea206bf46df83c3b040cb8664af/transactionId</from>
						<to>transactionId</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="0792c9fac4894395a9ca159d91047236"
							mask="false"
							optional="false"
							fixedValue="false">
						<from>serviceContextConnectionId</from>
						<to>connectionId</to>
					</steps>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
					disabled="false"
					id="6103ae73b0804cd18fdc2d76a43d33c4"
					lineNumber="7"
					query="input/stopped">
				<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
						comment="This is a start log"
						disabled="false"
						id="d208d7f4bb9e4a318535d0a5decf5bc5"
						label="null"
						lineNumber="8"
						scopeDefaultTransaction="true">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="f7832037082349b193b8b5e7559e289e"
							lineNumber="9">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="ed8bb1f702ad41448bd9435e8b089676"
								serviceId="nabu.utils.Runtime.getContext"
								resultName="result1013c87492cd453991f20654dabf41b0"
								temporaryMapping="true"
								x="107"
								y="76"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="e7d9986c40934c318fe52053d4232b43"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>process-automated-run</from>
								<to>key</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="bb0182c30bd94f0b94d1f4747cfdd6d9"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result1013c87492cd453991f20654dabf41b0/value</from>
							<to>automatedRunInput</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="3e1e60c869b8404d9c1d46703a0d5bbc"
								serviceId="nabu.utils.Date.now"
								resultName="result1b1e55f9acc344968637de547ad00b28"
								temporaryMapping="true"
								x="135"
								y="271"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="7d713c005ef04caeb9a24ad57b6532e6"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result1b1e55f9acc344968637de547ad00b28/date</from>
							<to>date</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="00baa0e3d7c44d7f98c39f23650a6596"
								serviceId="nabu.utils.Runtime.getCorrelationId"
								resultName="resulta7e7fc311992496c98948addb89a4d39"
								temporaryMapping="true"
								x="151"
								y="381"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="fa347436b00447f29bbb46af413c5167"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>resulta7e7fc311992496c98948addb89a4d39/correlationId</from>
							<to>correlationId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="2dadda6f493640b88fef3b8f6f0b8b05"
								serviceId="nabu.web.application.Services.getSessionId"
								resultName="result752d0bfe1abd475cadc793d0fc8d6f3b"
								temporaryMapping="true"
								x="147"
								y="490"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="32965165ecd3426baf30a458a0439fe1"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result752d0bfe1abd475cadc793d0fc8d6f3b/sessionId</from>
							<to>sessionId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="5fd6a67402de46368ef71b4e71e2c9a7"
								serviceId="nabu.utils.Runtime.getContext"
								resultName="result108cc344beba40ee8871a52bbf3ed6c9"
								temporaryMapping="true"
								x="115"
								y="180"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="efd1774d7bbc450bb67e6710cebbf937"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>processActionTaskId</from>
								<to>key</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="f7d989999b9640d3868d9c114d141e75"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result108cc344beba40ee8871a52bbf3ed6c9/value</from>
							<to>taskId</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							comment="If the automated run input is not for THIS service, we drop it. The problem is when an automated task runs and one of its child services is also tracked by the process engine"
							disabled="false"
							id="5aedce17a60b4950862d45ec42a17fa8"
							label="automatedRunInput/serviceId != null &amp;&amp; automatedRunInput/serviceId != input/name"
							lineNumber="10">
						<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
								disabled="false"
								id="828a2290b19e4bd3b893c025917cfb40"
								path="automatedRunInput" xsi:nil="true"/>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
							comment="Calculate what we want to run"
							disabled="false"
							id="bec7bd05bb5e44f0b7bad948cec6f61b"
							lineNumber="11">
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								features="FORCE"
								id="4c056c4bc7e2408183612416a7dcc529"
								lineNumber="12">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="428a07b565a7497e804ba537ef230762"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>true</from>
								<to>force</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								id="9e4599c8da104ca18ede899efb5202fa"
								label="automatedRunInput"
								lineNumber="13">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="f9eea163defd44838af28b814e67d83d"
									serviceId="nabu.frameworks.process.providers.action.service.utils.getProcessDefinition"
									resultName="result7d0b0dbaae8d47d3a2498b1c9542570c"
									temporaryMapping="true"
									x="83"
									y="163"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="a2e1643402594f11a24884ecf1aceeda"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/connectionId</from>
									<to>connectionId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="4579b463f6d4473a96dab7506f40db45"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/processVersionId</from>
									<to>processVersionId</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="309b77ab9ae541d992f9de79bf7e675f"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>result7d0b0dbaae8d47d3a2498b1c9542570c/definition</from>
								<to>automatedDefinition</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								id="09466aaddf234fd4a23c030d98b54aff"
								lineNumber="14">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="3a95f284e16340c5956c1789608b0ed0"
									serviceId="nabu.frameworks.process.providers.action.service.utils.getActionsToRun"
									resultName="resultf4d0f0c0ce5a4cc48d1cbc83f93d68af"
									temporaryMapping="true"
									x="486"
									y="45"
									invocationOrder="1"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="b0ba2ac983cb4227b7f8de54dd0f8a87"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/name</from>
									<to>serviceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="2f8a3e388ff648bd8c083c658007d2e9"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/input</from>
									<to>inputData</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="23e4c3da356c49b19151482e6b6a561b"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/device</from>
									<to>device</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="3bd3894d581c461ebbed20e99393e1e1"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/token</from>
									<to>token</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="357a1449ddd6468b858f36d2c901b856"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>force</from>
									<to>force</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="5b979396b9f44828a99a52e84762d28b"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resulte2d6c1ff2a6a48838e985ab869c91c1c/runningVersions</from>
									<to>allowedUnmatchableProcessVersionIds</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="9e0986642147456e96799651b182e746"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>serviceContextConnectionId</from>
									<to>connectionId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="dfb5f8d4272f4e17ba2bd74b33311028"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/processVersionId</from>
									<to>ignoreProcessVersionIds[0]</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="1c954b49db124e448bbc6178da71088c"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedDefinition/processDefinitionId</from>
									<to>ignoreProcessDefinitionIds[0]</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="5964ecbc2cb74bb4a22f7e0c576786fc"
										mask="false"
										optional="false"
										fixedValue="true">
									<from>=automatedRunInput != null</from>
									<to>automatic</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="10c1212edea2410c99e17187e9fe46e2"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/actionsToRun</from>
								<to>actionsToRun</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="00d56d736f1d463e8951b441ab99e776"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/incorrectStateProcessInstanceIds</from>
								<to>incorrectStateProcessInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="8cd6d74df93e44da86611615bf1070d9"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/conflictingStateProcessInstanceIds</from>
								<to>conflictingStateProcessInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="de663d9d3fed4a499b87b8670a5b8db3"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/errorProcessInstanceIds</from>
								<to>errorProcessInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="aef25c8dcdad4fcda4b5214c6e642bca"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/multipleProcessInstanceIds</from>
								<to>multipleProcessInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="9ce607038034440a8fbe0cf3a2da3619"
									serviceId="nabu.frameworks.process.providers.action.service.utils.getRunningVersions"
									resultName="resulte2d6c1ff2a6a48838e985ab869c91c1c"
									temporaryMapping="true"
									x="57"
									y="534"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="50836b6196d54af3892fa8fd7040280b"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/notAllowedProcessInstanceIds</from>
								<to>notAllowedProcessInstanceIds</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
								comment="An automated run, we know exactly what we are doing. If another process has a problem with it, tough luck"
								disabled="false"
								id="6ea784380ff44b95af57580326e75018"
								label="automatedRunInput"
								lineNumber="15">
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Drop the potential issues, we don't care"
									disabled="false"
									id="4e601b0e72d144a28dea922bdcbb593f"
									lineNumber="16">
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="afa5996e00d54b33b0b7c86ff88aee78"
										path="errorProcessInstanceIds" xsi:nil="true"/>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="025a8077821846038e7919a2d9e2d455"
										path="multipleProcessInstanceIds" xsi:nil="true"/>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="1443543300b049d0ab8a7c5419d56183"
										path="conflictingStateProcessInstanceIds" xsi:nil="true"/>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="0344761b566541bd801688efebf0c3e5"
										path="incorrectStateProcessInstanceIds" xsi:nil="true"/>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="449077ecd19848edbef96782a8e157df"
										path="notAllowedProcessInstanceIds" xsi:nil="true"/>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="We don't want to match with other actions from the same process. Currently this matches on version, we might want to match on definition?"
									disabled="false"
									id="5a60584ca39848bbb29de81a44e18f66"
									lineNumber="17">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="a4ef23d1af284706a72b5d0a5c879076"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>actionsToRun[processVersionId != /automatedRunInput/processVersionId]</from>
									<to>actionsToRun</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="abbd72bbaa0c46929bf680cad3b345ac"
									lineNumber="18">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="03fa8077ba63404180832b24dc8025f2"
										serviceId="nabu.frameworks.process.crud.processActionInstance.services.create"
										resultName="resulted1e6c124d184d7c889bec815780b35e"
										temporaryMapping="true"
										x="430"
										y="113"
										invocationOrder="1"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="386acc90e190431ebcd26f1bf39e7084"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>date</from>
										<to>instance/started</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c7bbe282d78346a68d5691bb11e84412"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>automatedRunInput/processStateInstanceId</from>
										<to>instance/processStateInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="8a05686d4ae049bf93773d7972db4841"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>automatedRunInput/actionId</from>
										<to>instance/processActionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="8c78677ed6914184b2a27425662b019d"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>result595665a9c3e64b90916c20d8fd638be5/server</from>
										<to>instance/serverOwner</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="97605ff6faef4b8f9de7a676fa2e8507"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>RUNNING</from>
										<to>instance/processState</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="cba2255a383f46a289cdfb99b1775b79"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>sessionId</from>
										<to>instance/sessionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="405b5e4d4ff84db38be9611b3d777f8a"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>correlationId</from>
										<to>instance/correlationId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="b74cf8218ca241099f7ce6ed29b31a14"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/device/deviceId</from>
										<to>instance/deviceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2a76d363c13d41db8d521d2767df772c"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/token/authenticationId</from>
										<to>instance/userId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f37ad2b2a465451783af79478a000f7e"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>taskId</from>
										<to>instance/taskId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a99505efee774e2586d97bb9730c362b"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/instanceId</from>
										<to>instance/runInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a7660e6b037d4a339ccdc88901b413b6"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="ad0a32ab074444aa8f43a43e5bd158a5"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resulted1e6c124d184d7c889bec815780b35e/created</from>
									<to>createdActions[0]</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="aa62e43688304b6793ca2944846a6fda"
										serviceId="nabu.utils.Server.getServerName"
										resultName="result595665a9c3e64b90916c20d8fd638be5"
										temporaryMapping="true"
										x="31"
										y="58"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="fcf9fa2cd6354b1d9809d48095638761"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/processInstanceId</from>
									<to>actionDescriptors[0]/processInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="9fa41ec778044a818e7e502cf93f393f"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/processStateInstanceId</from>
									<to>actionDescriptors[0]/processStateInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="14a4f913b692407b94b74613bef9a87f"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resulted1e6c124d184d7c889bec815780b35e/created/id</from>
									<to>actionDescriptors[0]/processActionInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="0bd19022772d469c94f7738b989279d6"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>automatedRunInput/actionId</from>
									<to>actionDescriptors[0]/processActionId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="90f200640bc54ba5a5a48d7d815a71ef"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.logActiveRelations"
										resultName="resultd665d6612bed4205b51c76a1a8061792"
										temporaryMapping="true"
										x="847"
										y="315"
										invocationOrder="2"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c3563926f1a241c1bdf5227fe5da21bc"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>date</from>
										<to>created</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="bd894f8e923d4455ae78d5c3c087467c"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resulted1e6c124d184d7c889bec815780b35e/created/id</from>
										<to>processActionInstance</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c648de2422ac4588a8ac1b46df0501bd"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>automatedRunInput/activatedRelations</from>
										<to>activatedRelations</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="d62d5b3f903948cd8f1e26c06fe46c1f"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="5a6721773231456c8c09625c397ea138"
										serviceId="nabu.frameworks.process.providers.action.service.utils.ensureQueueId"
										resultName="result079237e0534248d891915c613a2dd6d9"
										temporaryMapping="true"
										x="632"
										y="509"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="29e48b45f355425eaac5c3332009eb28"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>taskId</from>
										<to>taskId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="ef22fb14e09d44c195297fd14cb77152"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>automatedRunInput/processInstanceId</from>
										<to>processInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="aeebae9ae77747aab075e7462235b030"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
								</steps>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								id="a34aaffe05064d319030b581d619ab56"
								lineNumber="19">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="f54e9d702ce948cfb2f7d6c551a09e4b"
									serviceId="nabu.frameworks.process.providers.action.service.utils.handleGetActionsProblems"
									resultName="resultf9a8ba4a4081467d92ffe474485dba3d"
									temporaryMapping="true"
									x="341"
									y="89"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="3ca23ebb6f8d4bb19b5ef79482e3672e"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>incorrectStateProcessInstanceIds</from>
									<to>incorrectStateProcessInstanceIds</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="60507c877f514693b7b3625e14225a74"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>conflictingStateProcessInstanceIds</from>
									<to>conflictingStateProcessInstanceIds</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="4e9b432aeefb47e5ba7529ff65949b05"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>errorProcessInstanceIds</from>
									<to>errorProcessInstanceIds</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="4fa403ea83b94c57ad6a2f6ba4965e33"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>multipleProcessInstanceIds</from>
									<to>multipleProcessInstanceIds</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="c94ae673b5c84254acabfaaa08690ee1"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>serviceContextConnectionId</from>
									<to>connectionId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="6b3e1661cdd7416f8bfbc56d257a0c56"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/name</from>
									<to>name</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="6e0a31bfcfa24a40b7e74bcdbe647047"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>notAllowedProcessInstanceIds</from>
									<to>notAllowedProcessInstanceIds</to>
								</steps>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.For"
								disabled="false"
								id="95972818e71b438f9c52e83cf36f4361"
								lineNumber="20"
								variable="actionToRun"
								into="createdActions">
							<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
									disabled="false"
									id="cb05c7ec143f41ccb7c4479c204db9fc"
									lineNumber="21"
									query="actionToRun/newProcessInstance">
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Automated actions are asynchronously and only committed for running after the root transaction is finished. Should be fine to trigger them on start. Note we don't have captured state yet"
										disabled="false"
										id="cd5bf1d06df247a1a743004c73ef134c"
										label="true"
										lineNumber="22">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="b9fcc7f863614acd96d71245b34a3c67"
											serviceId="nabu.frameworks.process.crud.processStateInstance.services.create"
											resultName="result8bd9004fa2cb475da8fdd4300b5a011d"
											temporaryMapping="true"
											x="693"
											y="239"
											invocationOrder="1"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="fb9517e1c0c44f159b217e8c46a3639d"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processStateId</from>
											<to>instance/processStateId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="1ab430f7ae644104856335bb468391f4"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>date</from>
											<to>instance/started</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="7a96027176b04d12b761e18bcffeaac9"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>result6a10e9d5bc5b49ff98cc2044e4578bcb/instance/id</from>
											<to>instance/processInstanceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="cdfed341150b48718c2ec50654d99ea6"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>flow</from>
											<to>instance/reason</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="8f2e5bae3c374121a5c9d0ffd370d927"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="57280e2af075495f8ea8090653019b69"
											mask="true"
											optional="false"
											fixedValue="false">
										<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
										<to>stateInstance</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="c23ef97947a5437fa2464f66cc43c1c0"
											serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runStateAutomatic"
											resultName="resulta9724c95b0a944c08e2fb5918f64ef2d"
											temporaryMapping="true"
											x="856"
											y="523"
											invocationOrder="2"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="d9083f9d3c294f69800bc6e49bd9f4d6"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processActionId</from>
											<to>actionId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="650d8262a57e4294aaa4c952c9698794"
												mask="true"
												optional="false"
												fixedValue="false">
											<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
											<to>stateInstance</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="520354366abf4af8bcddd2fdb5e2f3cf"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processVersionId</from>
											<to>processVersionId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="28c6a151222641e1a1e1413cbe30e03a"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>defaultTransactionId</from>
											<to>transactionId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="3acdafc1634141e7b714e1b57632b592"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="824b413d8f6d4f1e96ffcad74dfc5888"
											serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.startProcess"
											resultName="result6a10e9d5bc5b49ff98cc2044e4578bcb"
											temporaryMapping="true"
											x="65"
											y="51"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="2693c36ea9fc49739fe2249271214061"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processVersionId</from>
											<to>processVersionId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="22f8bf7c17804bb5a8fe693944d80132"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processStateId</from>
											<to>initialStateId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="7af7bb842d814982ba46192afd005056"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/token/authenticationId</from>
											<to>userId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="2e4ede1d08d54b298dd62e5f27ed9443"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/device/deviceId</from>
											<to>deviceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="bd22d079984f43ab930505615c9d6638"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="c20b5a99f79943cab49252370e0a83b4"
											serviceId="nabu.utils.List.add"
											resultName="resulteb71f763de134d0293b9ea4bbe797b60"
											temporaryMapping="true"
											x="113"
											y="583"
											invocationOrder="1"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="fe766550c6f4489aac5d41e3706731f1"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>result6a10e9d5bc5b49ff98cc2044e4578bcb/instance/id</from>
											<to>object</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="0cf87a9d739041ac9dbfcae813ec318d"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>createdProcessInstanceIds</from>
											<to>list</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="528e1598c4994f9582ef566030caa6e2"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resulteb71f763de134d0293b9ea4bbe797b60/list</from>
										<to>createdProcessInstanceIds</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										disabled="false"
										id="e807219c832e4ce990bf350c70420580"
										lineNumber="23">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="a7588f91606d4ceeb5b32f6294fcf3ed"
											serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
											resultName="resultcc0cd201f62045f0825e241020bfd43a"
											temporaryMapping="true"
											x="244"
											y="167"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="12a5cd1cc76645458c032d2658e8ec28"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processInstanceId</from>
											<to>filter/processInstanceId[0]</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="aee4a542b5864c188d25d83503452726"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>actionToRun/processStateId</from>
											<to>filter/processStateId[0]</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="c4527ac452c04fd2895e38f82bfa9f85"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>true</from>
											<to>filter/running</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="6bda1f5b2023471a84e43bb7d8640d77"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f0bc911da13c4a8b9d174870b8fe3e05"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultcc0cd201f62045f0825e241020bfd43a/results[0]</from>
										<to>stateInstance</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
									comment="We may need to alter the state when running a forced action"
									disabled="false"
									id="b1fe8ecd49604888950dbcb81d45d42d"
									label="actionToRun/forced == true"
									lineNumber="24"
									query="actionToRun/forceStrategy">
								<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
										comment="Whatever state we are currently running in, stop it and start a new one."
										disabled="false"
										id="d03e1bd73e9342f9ae85aeebc75eb7c3"
										label="&quot;actionAndState&quot;"
										lineNumber="25">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get the current state if we don't have it (in that case it's a different state than the action is in)"
											disabled="false"
											id="8916ce873bf749809e4ad008612c147c"
											label="stateInstance == null"
											lineNumber="26">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="5cbed1087d94459c911b6c6ba457168c"
												serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
												resultName="resultcc0cd201f62045f0825e241020bfd43a"
												temporaryMapping="true"
												x="244"
												y="167"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="dabd8b91e2ce49c7ae94f5d4d717ab13"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>actionToRun/processInstanceId</from>
												<to>filter/processInstanceId[0]</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="bce633cf469d4cddbd4080686166d624"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>true</from>
												<to>filter/running</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="670822f14d6b49ab88d11b9fb18a7e1f"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connectionId</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="c57c8f82076741d7a4fbb78fc5c0bdeb"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>resultcc0cd201f62045f0825e241020bfd43a/results[0]</from>
											<to>stateInstance</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
											comment="Set the state to stopped"
											disabled="false"
											id="1d6e15302ffa4011ad27bcf845710ea9"
											label="stateInstance"
											lineNumber="27">
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												disabled="false"
												id="8fab386ec6dd497e993cd913b5476c72"
												lineNumber="28">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="862332e9127c4ff2a0893deaae155381"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>date</from>
												<to>stateInstance/stopped</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												disabled="false"
												id="ef0806034a234529bdb56026b49fb5a1"
												lineNumber="29">
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="89ed7889e1d94d88b9b89c1aaf2703d4"
													serviceId="nabu.services.jdbc.Services.update"
													resultName="result88f551f2727d4305b3725f89de9c2743"
													temporaryMapping="true"
													x="228"
													y="218"
													invocationOrder="0"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="1ef0d2f4e3784c56b214fab075906036"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>stateInstance</from>
													<to>instances[0]</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="cea1829ab3734857bca732354e31e30d"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>serviceContextConnectionId</from>
													<to>connection</to>
												</steps>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
											disabled="false"
											id="50fc0661e3d1406dbb3f5adb63b75eb2"
											lineNumber="30">
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												comment="If we remain in the same state (but new instance), we don't rerun the automatic transitions"
												disabled="false"
												id="5e21ea41898f472d81f1e82319b50309"
												label="stateInstance/processStateId == actionToRun/processStateId"
												lineNumber="31">
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="7f09757d3bda4b86acaec1a3f0696188"
													serviceId="nabu.frameworks.process.crud.processStateInstance.services.create"
													resultName="result8bd9004fa2cb475da8fdd4300b5a011d"
													temporaryMapping="true"
													x="289"
													y="180"
													invocationOrder="1"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="3a913ca6b76942e58f7a003775e73990"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processStateId</from>
													<to>instance/processStateId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="085b5244f4a64b43b5d62a1185342723"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>date</from>
													<to>instance/started</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="70ef19569ffb44b0b13fed35a197fb28"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>forced</from>
													<to>instance/reason</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="d093d588c2984bbbb8003824e919f66b"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processInstanceId</from>
													<to>instance/processInstanceId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="6a842d6395874c85bbde543a5b461e02"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>serviceContextConnectionId</from>
													<to>connectionId</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="9e46146b068b42eb90e0c22adc761a7b"
													mask="true"
													optional="false"
													fixedValue="false">
												<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
												<to>stateInstance</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												comment="Otherwise, we do run the automatic actions in this state"
												disabled="false"
												id="3840c732d28f4354a7eb45d6a6e06cec"
												lineNumber="32">
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="33e086efea85486994e5cd764e14c43c"
													serviceId="nabu.frameworks.process.crud.processStateInstance.services.create"
													resultName="result8bd9004fa2cb475da8fdd4300b5a011d"
													temporaryMapping="true"
													x="289"
													y="180"
													invocationOrder="1"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="2682209993c040e4901c373ebc1fa529"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processStateId</from>
													<to>instance/processStateId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="b130a8509e0f466285eeecdb1d979834"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>date</from>
													<to>instance/started</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="ea93bbba38a5449b8936af120aacdb4e"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>forced</from>
													<to>instance/reason</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="a2bf99476fa246a68ab9d9d377b4639e"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processInstanceId</from>
													<to>instance/processInstanceId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="afef7d1593474da8a6c78d5b00f958cd"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>serviceContextConnectionId</from>
													<to>connectionId</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="40850880e3b24c3ea3405f92296f6e79"
													mask="true"
													optional="false"
													fixedValue="false">
												<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
												<to>stateInstance</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="ae6011b09b594f55a793c5981f8eaeff"
													serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runStateAutomatic"
													resultName="resulta9724c95b0a944c08e2fb5918f64ef2d"
													temporaryMapping="true"
													x="569"
													y="447"
													invocationOrder="2"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="58141724c506461eb6428a8daee4e336"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processActionId</from>
													<to>actionId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="2f9766f56ad64ce99f20b92a6d8391ce"
														mask="true"
														optional="false"
														fixedValue="false">
													<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
													<to>stateInstance</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="6f7e842e974b42039f97fba7c5eb0f2e"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>actionToRun/processVersionId</from>
													<to>processVersionId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="d3cfed42c35540aa9d792b632ec7dd5d"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>defaultTransactionId</from>
													<to>transactionId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="580b32fc50a844e0bc4fe87e354b87fc"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>serviceContextConnectionId</from>
													<to>connectionId</to>
												</steps>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Update the process instance as well"
											disabled="false"
											id="8caabac6a9d64dea85458537e42c5e65"
											lineNumber="33">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="682cdcc021914181be9a4472417646f2"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.updateProcessInstanceState"
												resultName="result217d87b3766f4831a047db9d851ae094"
												temporaryMapping="true"
												x="188"
												y="96"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="cf10c8480dc84ba3bb3fef1965084d47"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>actionToRun/processInstanceId</from>
												<to>parameters[0]/processInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="2689d6798604476ca168c88430c17dd2"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstance/processStateId</from>
												<to>parameters[0]/stateId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="df10d3530d0f47be937267771d522138"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connection</to>
											</steps>
										</steps>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Throw"
									disabled="false"
									id="b95f997efe014c32a73722f06dabfc57"
									label="!stateInstance"
									lineNumber="34"
									code="PROCESS-INCONSISTENT-STATE"
									message="Could not find the the state instance"
									whitelist="false" xsi:nil="true"/>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="e270dc19dfe34413ab46799e0cef2429"
									label="actionToRun/reprocessable &amp;&amp; input/input != null"
									lineNumber="35">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="f9794efb5841403f9a4acda637abb0a9"
										serviceId="nabu.data.xml.Services.marshal"
										resultName="resultd619440b73c246099cfda315c9864151"
										temporaryMapping="true"
										x="133"
										y="84"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a0a460ce796240c19b5eaed250636a2e"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/input</from>
										<to>data</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="894613af2a5846ed9628b493a71debbb"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>true</from>
										<to>prettyPrint</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="23387d3246b0486792527d09fb97ff4b"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resultd619440b73c246099cfda315c9864151/marshalled</from>
									<to>serializedInput</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="46b32431bfb44d3491a8bcc9013b6cae"
									lineNumber="36">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="ffb2ea81b10146448458a63dcf9d62ff"
										serviceId="nabu.frameworks.process.crud.processActionInstance.services.create"
										resultName="result6d4a32aa509945bdb6081761dedb93db"
										temporaryMapping="true"
										x="422"
										y="92"
										invocationOrder="1"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="89ebded502ff4be29ec8d207a7a923bf"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>correlationId</from>
										<to>instance/correlationId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="46f7bc7cfa58430a8dd8116975b078d2"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>stateInstance/id</from>
										<to>instance/processStateInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f6e8594688cd4baab04f8ff317a33390"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processActionId</from>
										<to>instance/processActionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="d1e845b3a49242dabc39f4ce79c9c189"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/device/deviceId</from>
										<to>instance/deviceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="e0e4aa3f89a74140994810c22ae71720"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/token/authenticationId</from>
										<to>instance/userId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="e38c852a8e404d4e9879d51ce6ef006b"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>RUNNING</from>
										<to>instance/processState</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="4d04e135f95443bc8cdfee669bfa6fa1"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resulte46916ba00174ed3a766f8a96a05fdd9/server</from>
										<to>instance/serverOwner</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="1534d7c881d34526906fba2f4cbbed2c"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>date</from>
										<to>instance/started</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="57d99dfaf2ad4b70a6d30bd941e8d2fb"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serializedInput</from>
										<to>instance/input</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="af96951c60304cabae552add23a4f100"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>sessionId</from>
										<to>instance/sessionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="8ca08b84b36947e581bb243ed37fa0a1"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/nested</from>
										<to>instance/nested</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="ef3784b63a3e4f85928f63e43eb7ba3b"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>taskId</from>
										<to>instance/taskId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="bf409e0718374257b35a3c8a424566b2"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/instanceId</from>
										<to>instance/runInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="d40d4be239664d059c39c2e9ec795426"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/forced</from>
										<to>instance/forced</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="1afa7068650b472480ed4839baa5ecf8"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="43c6aa0cdba44422b0bf86a9b480c2c4"
										serviceId="nabu.utils.Server.getServerName"
										resultName="resulte46916ba00174ed3a766f8a96a05fdd9"
										temporaryMapping="true"
										x="70"
										y="213"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="c6bfbbef97f44efcb024942501adcce9"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>result6d4a32aa509945bdb6081761dedb93db/created</from>
									<to>createdActions[0]</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="8a173dc5b0354cb28ceb42afdfa311c9"
										path="serializedInput" xsi:nil="true"/>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="daba95fc7167420a8ec23a5986986614"
									lineNumber="37">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="d4aa586f53384e95a665d551cbe24e3c"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.updateProcessVariables"
										resultName="resulte68b99bf22784c6ea3573dd3d319b644"
										temporaryMapping="true"
										x="355"
										y="71"
										invocationOrder="1"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2cf85050b8b644b59506c912552969f6"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>stateInstance/processInstanceId</from>
										<to>processInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c7c932eac0b448d0a6df795893b88ee5"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/device/deviceId</from>
										<to>deviceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="9d0499f655584119ad6ae0824bb82e85"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="cc1a2afe39cb4ddd97e1d4cacc2f7af1"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>result76c647dd370f424ab803dc8eb9f7e49d/linkToUser</from>
										<to>linkToUser</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="084679817043440a803e40e69b38bb6a"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.shouldLinkToUser"
										resultName="result76c647dd370f424ab803dc8eb9f7e49d"
										temporaryMapping="true"
										x="157"
										y="267"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c3614062bc974cdca1a771688323f70e"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processVersionId</from>
										<to>processVersionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c965f44356814de8a15f4abf0c7d1fde"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processActionId</from>
										<to>processActionId</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Map descriptor"
									disabled="false"
									id="ee909239cdc8475eb2f4da4e1399e74a"
									lineNumber="38">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="5578f93073554bf99748888d82b0a477"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>stateInstance/processInstanceId</from>
									<to>actionDescriptor/processInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="54f68fc58a834292aaf55d09ea458e00"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>stateInstance/id</from>
									<to>actionDescriptor/processStateInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="7651106514bb45dca5be50a4d77e22cb"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>createdActions[0]/id</from>
									<to>actionDescriptor/processActionInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="e6835077d0054aeaa8609daa98f474ba"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>createdActions[0]/processActionId</from>
									<to>actionDescriptor/processActionId</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Add to descriptors"
									disabled="false"
									id="a2fa9e2faa584aafb98d9d7d910a3cab"
									lineNumber="39">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="8689ac7696014577bed0fcbb5a3f16dd"
										serviceId="nabu.utils.List.add"
										resultName="result2c7541065947433483c8cbbb7968c6d6"
										temporaryMapping="true"
										x="171"
										y="245"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="32f1e799aa364c9a8d7e98ed85dd5353"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionDescriptors</from>
										<to>list</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="3fe759300fcf42ae984cecd8dcacf352"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionDescriptor</from>
										<to>object</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="c5a3e00276e64a869f102b3a5fa28805"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>result2c7541065947433483c8cbbb7968c6d6/list</from>
									<to>actionDescriptors</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
										disabled="false"
										id="e6820c0b4a0341108d307c0efba56696"
										path="actionDescriptor" xsi:nil="true"/>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="cd1a77ed2bf247e3a40f9dd548e2c288"
									label="actionToRun/activatedRelations"
									lineNumber="40">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="e012c6da6c99435287705899e8bbd537"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.logActiveRelations"
										resultName="result880eb8ea1a4a472bb96d0d4e2436d0da"
										temporaryMapping="true"
										x="107"
										y="155"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="716aa1d399fa4ea7a37e1c1e69410789"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>createdActions[0]/id</from>
										<to>processActionInstance</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f85c5a80644f4413a0287ecc4516343d"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>createdActions[0]/started</from>
										<to>created</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="93ce147df3df4abba9057d048008a96b"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/activatedRelations</from>
										<to>activatedRelations</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="3f64722725e04b64b00a4fd8096b293b"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>serviceContextConnectionId</from>
										<to>connectionId</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="79f92219059b4b0d9558d6182b3cb2e9"
									lineNumber="41">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="b6d74e90dd464eb1af5ff6355a6f9683"
										serviceId="nabu.frameworks.process.providers.action.service.utils.pushRunningVersion"
										resultName="result782790191f784e88aeb8f172e8e7f60a"
										temporaryMapping="true"
										x="169"
										y="205"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="be55acaaa0344ba0965107016f439fe9"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processVersionId</from>
										<to>processVersionId</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="If we have used identification captures, store already so it can be used for nested service identification"
									disabled="false"
									id="376f0852c7fc4d5481c3f75d26e35821"
									label="actionToRun/identificationCaptures"
									lineNumber="42">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="fdbd79fa11c94d4483c5c60abf45658f"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.storeCaptured"
										resultName="result078f34d8b63541a0b38fbe2df419cd78"
										temporaryMapping="true"
										x="327"
										y="164"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="626cecb8a84d49d6aeb5bb1b83ca6afe"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/identificationCaptures</from>
										<to>capturedValues</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f551b04b684347bfac89aa869f6b3850"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>stateInstance/processInstanceId</from>
										<to>processInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2143f1d60d4644bebf88d13f1f03ef78"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processActionId</from>
										<to>actionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="77483ccede2b4602b1f74c15a09f6998"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>createdActions[0]/id</from>
										<to>actionInstanceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="90656d8e973a4b53844a9d2bd57f9293"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/name</from>
										<to>serviceId</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Add it to the context because we need it when the service is done and this is the easiest way currently"
									disabled="false"
									id="5e79e0a419ca4da58671e92c28aed7be"
									label="actionToRun/errorCondition != null &amp;&amp; !actionToRun/autoFail"
									lineNumber="43">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="0b06025817d64f6eae55438c7c4a29ce"
										serviceId="nabu.utils.Runtime.setContext"
										resultName="result2e913c724d20401bb1b7219c7367a11f"
										temporaryMapping="true"
										x="140"
										y="67"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="8c4b8b6e32fc46249b3d4a18e75c2fe5"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>="errorCondition-" + actionToRun/processActionId</from>
										<to>key</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="fee234a65c934c4e8b8af2985d804358"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/errorCondition</from>
										<to>value</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Add it to the context because we need it when the service is done and this is the easiest way currently"
									disabled="false"
									id="8c38053b72814dea82e4ab1a45f41d12"
									label="actionToRun/errorCondition != null &amp;&amp; actionToRun/autoFail"
									lineNumber="44">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="856d6a063b8442c59368ac0eadca72b9"
										serviceId="nabu.utils.Runtime.setContext"
										resultName="result2e913c724d20401bb1b7219c7367a11f"
										temporaryMapping="true"
										x="140"
										y="67"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="4dd0a662c28049ba91e1dee29d61e747"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>="failureCondition-" + actionToRun/processActionId</from>
										<to>key</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a59d6c47612f41739ba18b8a7f6a2cf5"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/errorCondition</from>
										<to>value</to>
									</steps>
								</steps>
							</steps>
							<query>actionsToRun</query>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="c7454bac39ff4f23a099aae104cc6720"
							label="createdActions"
							lineNumber="45">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="805498227f834e96a20226d3d0dc9520"
								serviceId="nabu.utils.Runtime.setContext"
								resultName="resultffb6241a460d48f59301ed367ffb3d50"
								temporaryMapping="true"
								x="86"
								y="145"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="1f07b00e225b48219bd91f90585181b4"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>="process-action-instances-" + input/instanceId</from>
								<to>key</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="92ce9173945846e5b6145dee6b8391e4"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>createdActions</from>
								<to>value</to>
							</steps>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="9d61d1e5cc164de5a6433ada72166933"
							label="actionDescriptors"
							lineNumber="46">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="03446090b2ba4ebb850d265dca1f177e"
								serviceId="nabu.utils.Runtime.setContext"
								resultName="resultffb6241a460d48f59301ed367ffb3d50"
								temporaryMapping="true"
								x="86"
								y="145"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="75e5e9868bf44901a709a949f948f38f"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>="process-action-descriptors:" + input/name</from>
								<to>key</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="0ccd3430021447dca4d28e6eeead7146"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>actionDescriptors</from>
								<to>value</to>
							</steps>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							comment="Make sure we register all locally created instances for rollback"
							disabled="false"
							id="9592bc6ba8194096b4829d62f035c6fc"
							lineNumber="47">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="94d2604ba9594f44a54caa515484c36d"
								serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.registerForRollback"
								resultName="resulta6c2a7a406744c0e8990176bfac281b1"
								temporaryMapping="true"
								x="213"
								y="80"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="b0e93b76e67d48209be5efd53a7401be"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>createdProcessInstanceIds</from>
								<to>processInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="7d6fc9fdc18142d685b27ba43e2d7274"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>createdActions/id</from>
								<to>processActionInstanceIds</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="62cd5fad73174f0e8c284e4220431258"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>defaultTransactionId</from>
								<to>transactionId</to>
							</steps>
						</steps>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
						comment="This is an end log"
						disabled="false"
						id="6f2534ad05cd40428f01fd6798fda7e7"
						lineNumber="48"
						scopeDefaultTransaction="true">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="c0d28d9ed94f406f824403af579579fe"
							lineNumber="49">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="845c5f375445405a9ac19f6e1c74c66b"
								serviceId="nabu.utils.Runtime.getContext"
								resultName="resultbeb16ef9c5614ff3a81febdc3b0c8894"
								temporaryMapping="true"
								x="211"
								y="165"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="978bc03e63a346f7845051c6fb433c3a"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>="process-action-instances-" + input/instanceId</from>
								<to>key</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="61cce57e32454957b58ef0d4d2018667"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>resultbeb16ef9c5614ff3a81febdc3b0c8894/value</from>
							<to>createdActions</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="a65e047d5e0f4a35b01b4a60cf0c2aa4"
								serviceId="nabu.utils.Date.now"
								resultName="result28e0ed9ff94740ec935ca7f9c55bb52e"
								temporaryMapping="true"
								x="229"
								y="275"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="46a2b69a6dc847578cd2712ad3d06509"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result28e0ed9ff94740ec935ca7f9c55bb52e/date</from>
							<to>date</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
							disabled="false"
							id="a935175a6a6642609f4537b89c7e24f9"
							label="createdActions"
							lineNumber="50">
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								comment="Get all state instances, we'll need them very likely"
								disabled="false"
								id="1aab3d08f4c041b78268d550f2e7b457"
								lineNumber="51">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="a8ef0f33ac2b426d8a6d8160f18a7a8f"
									serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
									resultName="resultfe86d821158242a4a81b15749e1cbd85"
									temporaryMapping="true"
									x="202"
									y="218"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="0ffadb8ec7414fedaa7608c15d41a523"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>createdActions/processStateInstanceId</from>
									<to>filter/id</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="b0703b03856246319887960049e7642f"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>serviceContextConnectionId</from>
									<to>connectionId</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="d634f4880c5143979c62560f1bdabd39"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultfe86d821158242a4a81b15749e1cbd85/results</from>
								<to>stateInstances</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								comment="Get process instances as well"
								disabled="false"
								id="822749cce63c49969106f2abe179fa37"
								label="stateInstances"
								lineNumber="52">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="354f818ec0984c26a6c5fa24812aa27a"
									serviceId="nabu.frameworks.process.crud.processInstance.services.list"
									resultName="result46693267717e400e85b763edd859714a"
									temporaryMapping="true"
									x="219"
									y="133"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="c2c7259b08944183a0c9cfb0e22576f7"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>stateInstances/processInstanceId</from>
									<to>filter/id</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="047c8c6a27b94d5396b92a03b47320f4"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>serviceContextConnectionId</from>
									<to>connectionId</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="57e769ff3d18445ea1df53f18f9d8e07"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>result46693267717e400e85b763edd859714a/results</from>
								<to>processInstances</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
								disabled="false"
								id="d7dfc72b009040efacf7e6103ac70ccc"
								lineNumber="53"
								query="input/exception">
							<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
									comment="No problem"
									disabled="false"
									id="c41d474a544140539c9b724c54fb824b"
									label="null"
									lineNumber="54">
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Capture all the variables we need"
										disabled="false"
										id="055c7ce56c504436af99054fe7ac9727"
										lineNumber="55">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="2ef370c8234444dc9472dcf5b1751f01"
											serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.getCapturedValues"
											resultName="resultc95bfd86945b4bce888d79bc1267480e"
											temporaryMapping="true"
											x="457"
											y="63"
											invocationOrder="1"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="488346121cfd4929a0cdd51972bc402a"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/name</from>
											<to>serviceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="43959283c7314bbfbde10ea41f8b3f7c"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>resultd4528a010d894c86bef356f75a5b8cf1/pipeline</from>
											<to>data</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="56c5f011738c4fc1afc49d7942b5b886"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a60c4079115d4ac386627aab6010c10a"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultc95bfd86945b4bce888d79bc1267480e/capturedValues</from>
										<to>finalCapturedValues</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="a3fb291664ea45b684283e8b044c58fb"
											serviceId="nabu.utils.Runtime.getPipeline"
											resultName="resultd4528a010d894c86bef356f75a5b8cf1"
											temporaryMapping="true"
											x="46"
											y="180"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="97a5b4b1a3fa49b6959ba314cc1c5c49"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/name</from>
											<to>serviceId</to>
										</steps>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.For"
										disabled="false"
										id="4c3827bcea0e40669ff64aff016a9c7f"
										lineNumber="56"
										variable="createdAction">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get the error condition (if any)"
											disabled="false"
											id="b6b2835321f14c7b97061b730494e8d9"
											lineNumber="57">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="7b1836c64c8c4a4aa77adafa45b43a7c"
												serviceId="nabu.utils.Runtime.getContext"
												resultName="result612f00db799a4366bb3c9717b8f283d1"
												temporaryMapping="true"
												x="227"
												y="52"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="a2aa48d259854397ac914c47091cc442"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>="errorCondition-" + createdAction/processActionId</from>
												<to>key</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="d2bd5984daf344cba2fdf8c185d6f407"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>result612f00db799a4366bb3c9717b8f283d1/value</from>
											<to>errorCondition</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="75b5908aecee47578aa3e428abebc8bc"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>false</from>
											<to>failed</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="71b7776ba29e4630b95f2ce2b8407a98"
												serviceId="nabu.utils.Runtime.getContext"
												resultName="resultee863c37bd10486cacd1f0d0764ba735"
												temporaryMapping="true"
												x="273"
												y="255"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="4e3a13e4084746328f9990aaf2af2ac5"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>="failureCondition-" + createdAction/processActionId</from>
												<to>key</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="bce8736a1dfc428faa21cbef6e4e6523"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>resultee863c37bd10486cacd1f0d0764ba735/value</from>
											<to>failureCondition</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="57f6676a79f94cadb82a6cea90dbb0e6"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>false</from>
											<to>error</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="7c006725a8284efd94967ebce3613ab6"
											label="errorCondition != null"
											lineNumber="58">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="51e380993546409fa1b1f2a4efbb5a44"
												serviceId="nabu.services.glue.Services.evaluate"
												resultName="result01aafd716675476b9b13eb0604b852ee"
												temporaryMapping="true"
												x="454"
												y="152"
												invocationOrder="1"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="b7accb9d0bac463ca5a2a58c77bea54e"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>errorCondition</from>
												<to>rule</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="02749e2ecf8646a3aa418cddee2ca488"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>resultb6fd2397b0fe4b928cce2332d9474624/pipeline</from>
												<to>context[0]</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="9c815f5e2bd04a9ab502d759c6dc0260"
												serviceId="nabu.utils.Runtime.getPipeline"
												resultName="resultb6fd2397b0fe4b928cce2332d9474624"
												temporaryMapping="true"
												x="93"
												y="29"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="6d05d9fc8e6e4df3998f62105e2b69aa"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>serviceId</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="67d1d56e08cd4e4ab8b968489b9690fd"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>result01aafd716675476b9b13eb0604b852ee/response</from>
											<to>error</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="7e45b0cb80ab4de886cf3fffc72dd624"
											label="failureCondition != null"
											lineNumber="59">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="f115bbaef84a48c1bc379d5f4024079b"
												serviceId="nabu.services.glue.Services.evaluate"
												resultName="result01aafd716675476b9b13eb0604b852ee"
												temporaryMapping="true"
												x="454"
												y="152"
												invocationOrder="1"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="8c0fc854798c473297ec0ec8e6c6d477"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>resultb6fd2397b0fe4b928cce2332d9474624/pipeline</from>
												<to>context[0]</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="ec312b44cf8841338c344755b22c68b8"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>failureCondition</from>
												<to>rule</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="e0f13bad98b74b6b86d3df8b6a9a66c5"
												serviceId="nabu.utils.Runtime.getPipeline"
												resultName="resultb6fd2397b0fe4b928cce2332d9474624"
												temporaryMapping="true"
												x="93"
												y="29"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="069a17171ae945fe8915f6400cf6c40f"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>serviceId</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="a19ff3ad2ba146ea9edf3b6becd21466"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>result01aafd716675476b9b13eb0604b852ee/response</from>
											<to>failed</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Basic mapping"
											disabled="false"
											id="95d2636edac64c1db67ad877755976b1"
											lineNumber="60">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="72e1339718a44d399eef134506bd224e"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>SUCCEEDED</from>
											<to>createdAction/processState</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="c0a1021cd2a0468c911ed6c2944be18b"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>date</from>
											<to>createdAction/stopped</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="We set it to failed instead of succeeded"
											disabled="false"
											id="51cfbe35b8c44de08bc8102fee8f8c6b"
											label="failed"
											lineNumber="61">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="7be6d53ea2a8492787bb1c00976a3dea"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>FAILED</from>
											<to>createdAction/processState</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="ff79e1703f1d447581092d0219c9a76e"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>="Failure condition triggered: " + failureCondition</from>
											<to>createdAction/error</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="4c988da5bb7248469ea24113686bcbeb"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.fireConditionalErrorEvent"
												resultName="result3a5d41b870984a90968f7c81ddf7dda5"
												temporaryMapping="true"
												x="138"
												y="50"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="ebfc4ba298014113b7db52ee4db2b49c"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>processActionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="504c9d274a744eb2a3bd81766aee5029"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstances[id == /createdAction/processStateInstanceId]/processInstanceId</from>
												<to>processInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="0f7adf91a6b241df99db37d1dc076148"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>service</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="8edb14ad3b8e4474b104b3ddcc549a3c"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>true</from>
												<to>failed</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="a119e81161a94aa8a6ab08b2c5059ead"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>failureCondition</from>
												<to>condition</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="8b596f6c92e7482cb6da2fc325431bfa"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>condition</from>
											<to>createdAction/reason</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="We set it to error instead of succeeded"
											disabled="false"
											id="de87894427f04495812809d20410cc94"
											label="error"
											lineNumber="62">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="8094c9c8b41b435480f84b4aa710d0e2"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>ERROR</from>
											<to>createdAction/processState</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="599217c1cdf6420099ecc95ff7a4143f"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>="Error condition triggered: " + errorCondition</from>
											<to>createdAction/error</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="bbb4fc76219b4ed7a9e7fe5a9c05e6f4"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.fireConditionalErrorEvent"
												resultName="resultf20fb3a1156043c083390d616b330677"
												temporaryMapping="true"
												x="46"
												y="74"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="a89097923f6f4a5e95726950b6c96beb"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstances[id == /createdAction/processStateInstanceId]/processInstanceId</from>
												<to>processInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="292650ed2c5a47129298c7dfc6216a65"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>processActionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="a4aa37d6b24449328064ebf2097214f1"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>service</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="38149b5d0b5144a28003ce09148c2be3"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>false</from>
												<to>failed</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="c0c6d0cb612f428a809ad5edd68ee8eb"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>errorCondition</from>
												<to>condition</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="72a80bd4d76a411f80e9ce6ca20b64f8"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>condition</from>
											<to>createdAction/reason</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="834cf25a740c4156ba4dd62382e09ba8"
											label="finalCapturedValues"
											lineNumber="63">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="537bf16f947b41cc80c9d90d1e94828b"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.storeCaptured"
												resultName="resulted4c24f32a0945a9bd0142fa74547242"
												temporaryMapping="true"
												x="266"
												y="62"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="179950733f904f2aaf32f9a278981c1b"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>serviceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="f1dcb8b6ba984c44850c8be143693532"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>actionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="437045ccc0af46f3b92c9919c5c2363e"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/id</from>
												<to>actionInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="9109a71072f149aa935c92c152cd56ab"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstances[id == /createdAction/processStateInstanceId]/processInstanceId</from>
												<to>processInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="d526133804bb428e94da93a64b490743"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>finalCapturedValues</from>
												<to>capturedValues</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="701b2f895c3d4853a9c16b5232e032a1"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connectionId</to>
											</steps>
										</steps>
									</steps>
									<query>createdActions</query>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="We want to get all data for all processes in one select. This means we need to process all data capturing for actions first. This allows us to calculate conditions"
										disabled="false"
										id="a7572350177d4250bf70ddf260a3220d"
										lineNumber="64">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="ce599abe25e24f8c87028e26cdf14a85"
											serviceId="nabu.frameworks.process.crud.processData.services.list"
											resultName="resultb1890bfb15dc4f909e09b50620e0471a"
											temporaryMapping="true"
											x="160"
											y="54"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="4c44685070334bd29b385687ed2aa55e"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>stateInstances/processInstanceId</from>
											<to>filter/processInstanceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="6ec049ee1255440cb8576de4f8d3aa6d"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>true</from>
											<to>filter/active</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="9fe04307ca9049089a8701e61da94a7c"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="e82f0f1ee1e34ba58273c30a7d302bec"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultb1890bfb15dc4f909e09b50620e0471a/results</from>
										<to>allData</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.For"
										disabled="false"
										id="63f5371453d54edda9cc652457911d45"
										lineNumber="65"
										variable="createdAction">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get state instance for action instance"
											disabled="false"
											id="2017d8e76b2443a4aa773a6f2add027f"
											lineNumber="66">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="ca8c2c60a9b24555b1ff43a5cf53781a"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>stateInstances[id == /createdAction/processStateInstanceId]</from>
											<to>stateInstance</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get the process instance"
											disabled="false"
											id="a7b9f26eb7db45e88c8834ddc86496db"
											label="stateInstance"
											lineNumber="67">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="5aa1fc9bd29f484d8ab7fafeefd64034"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>processInstances[id == /stateInstance/processInstanceId]</from>
											<to>processInstance</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Map description"
											disabled="false"
											id="c1f0bd44b7114ef5884d2760d4da8680"
											label="processInstance"
											lineNumber="68">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="e572e392bd0945129493d58e98430685"
												serviceId="nabu.frameworks.process.providers.action.service.utils.resolveDescription"
												resultName="resultb48f49b8633b49c9a4d17aa8cde3f3d4"
												temporaryMapping="true"
												x="164"
												y="185"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="2d71f70e6e9048a79c1a87748dd088d9"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>processActionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="4115e0ee94e94da19664f751a88d8d6d"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>finalCapturedValues</from>
												<to>capturedValues</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="03a6c4f0b9b0464c98ca7fc1bcaf0d58"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>processInstance/processVersionId</from>
												<to>processVersionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="fd5bb1735fe14c24a273e21b45f0b862"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connectionId</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="8411810155e342e6afb89aa4bc6cbefe"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>resultb48f49b8633b49c9a4d17aa8cde3f3d4/description</from>
											<to>createdAction/description</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get the applicable data"
											disabled="false"
											id="528c9c1c16594abdb1fd51fec3d28f4b"
											lineNumber="69">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="5ecc47c779564750b2959c18badea251"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>allData[processInstanceId == /stateInstance/processInstanceId]</from>
											<to>applicableData</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Update the action BEFORE we run the specials"
											disabled="false"
											id="704eb616f52f48268787ac2dd4460bb5"
											lineNumber="70">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="304131f8988942b8b2e5acdc7aa3e03d"
												serviceId="nabu.services.jdbc.Services.update"
												resultName="resulta4491316b050480499905b8d4424bc01"
												temporaryMapping="true"
												x="154"
												y="234"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="fd3d1298075f4fa0bc50feac535f60dd"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction</from>
												<to>instances[0]</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="793d4907090d485c8c60b8cc00616d54"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connection</to>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Only run specials if it is not in error"
											disabled="false"
											id="313f0e48b34d4ab8b745aa5903c27f77"
											label="createdAction/processState != &quot;ERROR&quot;"
											lineNumber="71">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="c2c78cdf6bde4fe4bc07cdcabe396804"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runSpecials"
												resultName="result0b1fddf7a28b4f0f813069777353eb06"
												temporaryMapping="true"
												x="216"
												y="135"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="c786c7c40f324acbb38e29f742de5167"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstance</from>
												<to>stateInstance</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="0e94a1096b804c878fe92004add62bb2"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>applicableData</from>
												<to>processData</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="3ea8dad378014482b3821986b19ecaaf"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>actionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="3a3d9ffdbc494ceb92ba4139be5cc960"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>processInstance/processVersionId</from>
												<to>processVersionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="de3356d6319e476baaed0e246faf1fb0"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>defaultTransactionId</from>
												<to>transactionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="bc393b8a51b64aa5b86e7ec812a334e6"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>serviceContextConnectionId</from>
												<to>connectionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="f6bec555c9b7496191072b483e0d6fa8"
													mask="false"
													optional="false"
													fixedValue="true">
												<from>=createdAction/processState == "FAILED"</from>
												<to>failed</to>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="42b935648be64166b45ee228b361647f"
											lineNumber="72">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="7bd6704c08b24c86b653dd735cb2e9e0"
												serviceId="nabu.frameworks.process.providers.action.service.utils.popRunningVersion"
												resultName="result5ca4eb42501a4f6797641f9b063d9016"
												temporaryMapping="true"
												x="263"
												y="339"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="a26bf74e4cfd40c48b0a830c4bd679d5"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>processInstance/processVersionId</from>
												<to>processVersionId</to>
											</steps>
										</steps>
									</steps>
									<query>createdActions</query>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
									disabled="false"
									id="9dd357b7c76a492d8367c2ccaefb18a5"
									lineNumber="73">
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Get action definitions"
										disabled="false"
										id="ad2f39ee15af4f80aaf4da3f4511233f"
										lineNumber="74">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="15cae2b9cf9a48a189ed71c925ffddfb"
											serviceId="nabu.frameworks.process.crud.processAction.services.list"
											resultName="resultb4e8c026a9714acbbfc21c6b9f8e09cd"
											temporaryMapping="true"
											x="44"
											y="67"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="372fb3540bb94dd580c5b61c7d4c16b5"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>createdActions/processActionId</from>
											<to>filter/id</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="5e9b2a19e8f2438b91fe107c03cf7045"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="f8fc51caf6de41119744b81ca950e83d"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultb4e8c026a9714acbbfc21c6b9f8e09cd/results</from>
										<to>errorActionDefinitions</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="We want to get all data for all processes in one select. This means we need to process all data capturing for actions first. This allows us to calculate conditions"
										disabled="false"
										id="cdd5f61254b0432d9709d5ac672e66f3"
										lineNumber="75">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="75bbf76dc05e4d7aab2f8386ec70bb0a"
											serviceId="nabu.frameworks.process.crud.processData.services.list"
											resultName="resultb1890bfb15dc4f909e09b50620e0471a"
											temporaryMapping="true"
											x="160"
											y="54"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="8185befa71014c20a2abae91fd075562"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>stateInstances/processInstanceId</from>
											<to>filter/processInstanceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="739807c3dce84caf932e82ab943474b7"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>true</from>
											<to>filter/active</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="0662b9c347894af4928fe7e7ce6fff0d"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>serviceContextConnectionId</from>
											<to>connectionId</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c498b26ad2684f32a5d0da0d4734a768"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultb1890bfb15dc4f909e09b50620e0471a/results</from>
										<to>allData</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.For"
										comment="Is problem"
										disabled="false"
										id="b546ab82a7c94b6d82218703e540e52c"
										lineNumber="76"
										variable="createdAction">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get definition"
											disabled="false"
											id="dd4ed319b9c74fd38b1133e24d108c03"
											lineNumber="77">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="f531a68c28c442e98fd7e315f6fd6778"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>errorActionDefinitions[id == /createdAction/processActionId]</from>
											<to>errorActionDefinition</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
											disabled="false"
											id="c7ad5ca204ec451ea618bf66c0f557a9"
											lineNumber="78"
											query="errorActionDefinition/autoFail">
										<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
												disabled="false"
												id="6fc8cb8572a34f69840ac4b3712b4985"
												label="true"
												lineNumber="79">
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Get state instance for action instance"
													disabled="false"
													id="1ff52b7a0caf4fccac18fe8bb85a1492"
													lineNumber="80">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="0a224a195a8548338dff5cde4346ec94"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>stateInstances[id == /createdAction/processStateInstanceId]</from>
													<to>stateInstance</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Get the process instance"
													disabled="false"
													id="be99d08356254678a6bf840ab4b4947b"
													lineNumber="81">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="2481981fda0a40a38568326e4afe9d57"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>processInstances[id == /stateInstance/processInstanceId]</from>
													<to>runningProcess</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Set the error on the action and process"
													disabled="false"
													id="92b72e331463419793fb1242b5f7d2a0"
													lineNumber="82">
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="be5e94e027b84109ad9b29f586336253"
														serviceId="nabu.utils.Runtime.summarizeException"
														resultName="resulted3829100017498b97336741f67c60e1"
														temporaryMapping="true"
														x="108"
														y="137"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="adc9b24df7be4586b2e669e0c377cb5c"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>input/exception</from>
														<to>exception</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="49b65d26c69941baaa2a71f846b7bce3"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>resulted3829100017498b97336741f67c60e1/summary/exceptionStack</from>
													<to>createdAction/error</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="7d980861240c48e58cf0f7fa4f460866"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>FAILED</from>
													<to>createdAction/processState</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="3a105c268be94703bf016ded73ea3be5"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>date</from>
													<to>createdAction/stopped</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="27ed038102054e06b888170b8b7fa813"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>resulted3829100017498b97336741f67c60e1/summary/code</from>
													<to>createdAction/code</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="90f21b536a1d46f596dee98521b8b78c"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>exception</from>
													<to>createdAction/reason</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													disabled="false"
													id="5aabe2dbcaa248198b4328deac570001"
													lineNumber="83">
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="d1d855af348b4097867e05f2d16a2157"
														serviceId="nabu.frameworks.process.crud.processActionInstance.services.update"
														resultName="resultec829bf2c2104b21964acf31cc927965"
														temporaryMapping="true"
														x="421"
														y="105"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="627cf73c6707476eb4be12b4841746ee"
															mask="true"
															optional="false"
															fixedValue="false">
														<from>createdAction</from>
														<to>instance</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="53fc73c37c7d4b9c94e6283540de39e8"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>createdAction/id</from>
														<to>id</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="cacec24415e74ad18685e0f7a843720f"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>serviceContextConnectionId</from>
														<to>connectionId</to>
													</steps>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Get the error condition (if any)"
													disabled="false"
													id="e8086c4100c84029863586f4258d13ad"
													lineNumber="84">
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="e18a2636d68a4728a35bf53723b8b4e7"
														serviceId="nabu.utils.Runtime.getContext"
														resultName="result612f00db799a4366bb3c9717b8f283d1"
														temporaryMapping="true"
														x="227"
														y="52"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="d210ed84ccb84cb1af6d7064df9037dd"
															mask="false"
															optional="false"
															fixedValue="true">
														<from>="errorCondition-" + createdAction/processActionId</from>
														<to>key</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="b77cfc8a5218496f8b4b71ecd36d7c8e"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>result612f00db799a4366bb3c9717b8f283d1/value</from>
													<to>errorCondition</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="aa4f1aa67ec34573b42db8a3566ce3ab"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>false</from>
													<to>failed</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="4db440cab3774c589ec4a8b0d3fc5175"
														serviceId="nabu.utils.Runtime.getContext"
														resultName="resultee863c37bd10486cacd1f0d0764ba735"
														temporaryMapping="true"
														x="273"
														y="255"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="46396958dd024399a81296d130fd3b58"
															mask="false"
															optional="false"
															fixedValue="true">
														<from>="failureCondition-" + createdAction/processActionId</from>
														<to>key</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="df5d6fa49eb846c7a8542c5cc224568b"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>resultee863c37bd10486cacd1f0d0764ba735/value</from>
													<to>failureCondition</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="5bafeb6572e0483dbe7b778f9868c6fc"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>false</from>
													<to>error</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
													comment="If we have an error or failure condition, we are using a business level definition of failure and do NOT want service exceptions to trigger the failure line"
													disabled="false"
													id="02cbe84f76a34065a622b5304708e6e9"
													label="errorCondition == null &amp;&amp; failureCondition == null"
													lineNumber="85">
												<steps xsi:type="be.nabu.libs.services.vm.step.Map"
														comment="Get the applicable data"
														disabled="false"
														id="233cecf30def4881ba96b9e42423d69c"
														lineNumber="86">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="efc0e533bef442dd9bc678c0ba3550de"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>allData[processInstanceId == /stateInstance/processInstanceId]</from>
														<to>applicableData</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Map"
														comment="If we set to failed immediately, run the specials in failed mode"
														disabled="false"
														id="a17c43f7c7224ad1b0da47de68f138b7"
														lineNumber="87">
													<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
															disabled="false"
															id="d11ede46d6494a7ea53195e298136989"
															serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runSpecials"
															resultName="result0b1fddf7a28b4f0f813069777353eb06"
															temporaryMapping="true"
															x="216"
															y="135"
															invocationOrder="0"
															asynchronous="false"
															recache="false">
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="bbd1e13e92d148638200f0e38556392c"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>stateInstance</from>
															<to>stateInstance</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="2e03b2efc88d40d68febcb282c9e4a8b"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>applicableData</from>
															<to>processData</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="465608c9969445e1a681a996166928be"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>createdAction/processActionId</from>
															<to>actionId</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="245139deec3b4e9babeee53f7200c70f"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>defaultTransactionId</from>
															<to>transactionId</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="4627282ba8694a559a36bb6d5bd03141"
																mask="false"
																optional="false"
																fixedValue="true">
															<from>true</from>
															<to>failed</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="9e1d6d24bae44a8fb4e3e9ac29b202ed"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>runningProcess/processVersionId</from>
															<to>processVersionId</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="f11ddb7128dc4b0dba14d7e63a05d320"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>serviceContextConnectionId</from>
															<to>connectionId</to>
														</steps>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="ab579ebc764045d1ac954b08f51c3275"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>result0b1fddf7a28b4f0f813069777353eb06/ranAnything</from>
														<to>ranAnything</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Map"
														comment="If we ran anything in the FAILED condition, we don't want to update the entire process to failed. We do this by removing it from the &quot;created process instance&quot; list which is what is reset"
														disabled="false"
														id="17419a067b2e480796a3bf7d40d143fd"
														label="ranAnything"
														lineNumber="88">
													<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
															disabled="false"
															id="d84a3234723640c8bfd5d5f7fdc7ac44"
															serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.unregisterForRollback"
															resultName="result533af57ae40b4972ad05e05958da42e8"
															temporaryMapping="true"
															x="206"
															y="99"
															invocationOrder="0"
															asynchronous="false"
															recache="false">
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="c101c872507b4965a61fcdb12ee60b7b"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>defaultTransactionId</from>
															<to>transactionId</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="d05aed93f56b4cbe822e571ac79bd8a1"
																mask="false"
																optional="false"
																fixedValue="false">
															<from>runningProcess/id</from>
															<to>processInstanceIds[0]</to>
														</steps>
													</steps>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
													comment="Check if we need to set the task to failed as well"
													disabled="false"
													id="ada28c30627947c68e44218f3fc679f2"
													lineNumber="89">
												<steps xsi:type="be.nabu.libs.services.vm.step.Map"
														disabled="false"
														id="9727b2da80f8469381c7d25a2fdcde6b"
														lineNumber="90">
													<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
															disabled="false"
															id="9864d367376745e0b4ae641368fd47cf"
															serviceId="nabu.utils.Runtime.getContext"
															resultName="result625f1425f8ae4424a1bfc13b19f5d0e7"
															temporaryMapping="true"
															x="246"
															y="53"
															invocationOrder="0"
															asynchronous="false"
															recache="false">
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="a57f6ece16884684aa93b5435410cee2"
																mask="false"
																optional="false"
																fixedValue="true">
															<from>process-automated-run</from>
															<to>key</to>
														</steps>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="9566612392dc4d5fb3d809cb7143b4f1"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>result625f1425f8ae4424a1bfc13b19f5d0e7/value</from>
														<to>automatedRunInput</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Map"
														comment="If the automated run matches the current action being considered, set the taskFail. We don't want to do this when ignoring nested exceptions"
														disabled="false"
														id="2913a7b9d0324509bbcd1d662a3ab1c3"
														label="automatedRunInput/actionId == createdAction/processActionId &amp;&amp; automatedRunInput/processInstanceId == runningProcess/id"
														lineNumber="91">
													<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
															disabled="false"
															id="a91f7e0e287b4107bface0efb7f4ac3c"
															serviceId="nabu.utils.Runtime.setContext"
															resultName="result9ebf37e0252b4497a800548c0454b197"
															temporaryMapping="true"
															x="108"
															y="114"
															invocationOrder="0"
															asynchronous="false"
															recache="false">
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="ae6567943e894d92a5dbd6a3b18debe0"
																mask="false"
																optional="false"
																fixedValue="true">
															<from>taskFail</from>
															<to>key</to>
														</steps>
														<steps xsi:type="be.nabu.libs.services.vm.step.Link"
																disabled="false"
																id="bfe2b536995140ac94152336f0111381"
																mask="false"
																optional="false"
																fixedValue="true">
															<from>true</from>
															<to>value</to>
														</steps>
													</steps>
												</steps>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
												disabled="false"
												id="cdfe398414944296a6caa6571cbceedb"
												lineNumber="92">
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Get state instance for action instance"
													disabled="false"
													id="2b1027dfbde44199ae7e292ae67d8567"
													lineNumber="93">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="58b933a346b340baab3cce0157be6576"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>stateInstances[id == /createdAction/processStateInstanceId]</from>
													<to>stateInstance</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Get the process instance"
													disabled="false"
													id="2d44bae1a29944caa642b2e1dcc18589"
													lineNumber="94">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="aeb492c7fe10434780f3bd56c315086b"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>processInstances[id == /stateInstance/processInstanceId]</from>
													<to>runningProcess</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Set the error on the action and process"
													disabled="false"
													id="366ec4c18e0643bba1a88dbd7cb510ee"
													lineNumber="95">
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="92446e872ff341b3994d5ca4a6d0e254"
														serviceId="nabu.utils.Runtime.summarizeException"
														resultName="resulted3829100017498b97336741f67c60e1"
														temporaryMapping="true"
														x="108"
														y="137"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="47f6d89be41e4735add7b55d7d88bc07"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>input/exception</from>
														<to>exception</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="f320ea04b35d4e74b821dbddee30ef35"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>resulted3829100017498b97336741f67c60e1/summary/exceptionStack</from>
													<to>createdAction/error</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="4dc6e805b3a341dcaebb4fc65a803536"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>ERROR</from>
													<to>createdAction/processState</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="48ae7c56d1f04bc5bd9ab7191e0ecc4a"
														mask="false"
														optional="false"
														fixedValue="true">
													<from>ERROR</from>
													<to>runningProcess/processState</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="76cbbe46b5ff4424a9d20c7395d4af81"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>date</from>
													<to>createdAction/stopped</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="507f944b2e82475e87388cade1440399"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>resulted3829100017498b97336741f67c60e1/summary/code</from>
													<to>createdAction/code</to>
												</steps>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Map"
													comment="Update both"
													disabled="false"
													id="bc396cfb8dd64849993364093cbdafc7"
													lineNumber="96">
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="14764175b424466189cae6b0a93d5525"
														serviceId="nabu.frameworks.process.crud.processInstance.services.update"
														resultName="result197ba6bbd4e64755bf1f10b0d0e1dd6a"
														temporaryMapping="true"
														x="233"
														y="99"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="58a34930c55c4ee496816a560758a52f"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>runningProcess/id</from>
														<to>id</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="442b79c49e1f42a4a2be095b0f19e33a"
															mask="true"
															optional="false"
															fixedValue="false">
														<from>runningProcess</from>
														<to>instance</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="e77ad8b46bff42a18b8d71ce4d97268d"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>serviceContextConnectionId</from>
														<to>connectionId</to>
													</steps>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
														disabled="false"
														id="a81cfeebd23140178226a37967903500"
														serviceId="nabu.frameworks.process.crud.processActionInstance.services.update"
														resultName="resultec829bf2c2104b21964acf31cc927965"
														temporaryMapping="true"
														x="248"
														y="276"
														invocationOrder="0"
														asynchronous="false"
														recache="false">
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="1503f1443296461cabcbc4eaf083c4c8"
															mask="true"
															optional="false"
															fixedValue="false">
														<from>createdAction</from>
														<to>instance</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="761cba43abf64a7f82e298e43612afc5"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>createdAction/id</from>
														<to>id</to>
													</steps>
													<steps xsi:type="be.nabu.libs.services.vm.step.Link"
															disabled="false"
															id="86ff5a15504b4fae913daa7ac15caa5b"
															mask="false"
															optional="false"
															fixedValue="false">
														<from>serviceContextConnectionId</from>
														<to>connectionId</to>
													</steps>
												</steps>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="6f92b0c62d2b47518fbc3394866706d8"
											lineNumber="97">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="c41faaedc9024cc39d4942e5ee5cd128"
												serviceId="nabu.frameworks.process.providers.action.service.utils.popRunningVersion"
												resultName="result5ca4eb42501a4f6797641f9b063d9016"
												temporaryMapping="true"
												x="263"
												y="339"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="52d288381970491b925216328d3ad7c7"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>runningProcess/processVersionId</from>
												<to>processVersionId</to>
											</steps>
										</steps>
									</steps>
									<query>createdActions</query>
								</steps>
							</steps>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							comment="Remove from memory"
							disabled="false"
							id="2b0ec9f2df804c2c8cda11fbf57a8668"
							lineNumber="98">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="7e267e6701554d9aa3c63d3a49ee0528"
								serviceId="nabu.utils.Runtime.setContext"
								resultName="resulte5bf4535af864187a889a5e1bdbdd859"
								temporaryMapping="true"
								x="130"
								y="105"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="c1a031f02cde486b9f0ef5dbcc2e46b7"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>="process-action-instances-" + input/instanceId</from>
								<to>key</to>
							</steps>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							comment="Remove action descriptors from memory"
							disabled="false"
							id="7cd3831f6eb64ab991cfcc88d9c7643c"
							lineNumber="99">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="232d7133b657400da3d402c61021a06f"
								serviceId="nabu.utils.Runtime.setContext"
								resultName="resultffb6241a460d48f59301ed367ffb3d50"
								temporaryMapping="true"
								x="86"
								y="145"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="0ec65d60daf047bba2408f290c80eb27"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>="process-action-descriptors:" + input/name</from>
								<to>key</to>
							</steps>
						</steps>
					</steps>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
				disabled="false"
				id="e0ee9dd4612349a6ab18bbc8573e9653"
				label="&quot;DESCRIPTION&quot;"
				lineNumber="100">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map"
					disabled="false"
					id="f691e4f47bc64a2291c7c816f065c587"
					lineNumber="101">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
						disabled="false"
						id="f74a9369b5a64930a4fa7b4cdb25eff5"
						serviceId="nabu.utils.Runtime.getContext"
						resultName="resultbeb16ef9c5614ff3a81febdc3b0c8894"
						temporaryMapping="true"
						x="211"
						y="165"
						invocationOrder="0"
						asynchronous="false"
						recache="false">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="9d1a4633d04146c9ae2a568ca58c2f5b"
							mask="false"
							optional="false"
							fixedValue="true">
						<from>="process-action-instances-" + input/instanceId</from>
						<to>key</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="8fb8f045f61a44d18d686f77367258ff"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>resultbeb16ef9c5614ff3a81febdc3b0c8894/value</from>
					<to>createdActions</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
					disabled="false"
					id="379b6c5d7de74444bd5837dc4aef608b"
					label="createdActions != null &amp;&amp; input/input != null"
					lineNumber="102"
					scopeDefaultTransaction="true">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map"
						disabled="false"
						id="a0a47f80d24647298442b05a0aedeb66"
						lineNumber="103">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
							disabled="false"
							id="4f009a61d3fc496188675117a17cfc47"
							serviceId="nabu.utils.reflection.Type.whatIs"
							resultName="resultdde862c27b9e4ad7b97d08215a86824e"
							temporaryMapping="true"
							x="267"
							y="52"
							invocationOrder="0"
							asynchronous="false"
							recache="false">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="2b8d15b824e04b35aa4783cf7a13c9c3"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>input/input</from>
							<to>object</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="ac694f23be414ac4829b441940e0933b"
							mask="false"
							optional="false"
							fixedValue="false">
						<from>resultdde862c27b9e4ad7b97d08215a86824e/description</from>
						<to>description</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
						disabled="false"
						id="1c81604a37f0448da225687d8c752d61"
						lineNumber="104"
						query="description/complex">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="f7f072cd17a14e0bac88129f579cad18"
							label="true"
							lineNumber="105">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="350f294a15264546b9cd1a38f5bbdd5a"
								serviceId="nabu.data.json.Services.marshal"
								resultName="result1480fcfcf99542a99646dd3828e1f6c3"
								temporaryMapping="true"
								x="198"
								y="92"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="a83d2f01ccbf40b6acfb7d57926ab9ca"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>input/input</from>
								<to>data</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="4e9835816cc54712b4d3c1dfac8ffae5"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>true</from>
								<to>prettyPrint</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="7225a7fbd72f4b76a7a74cb932f36b9e"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result1480fcfcf99542a99646dd3828e1f6c3/marshalled</from>
							<to>logBinding</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="fb986c7d1aff4f12a90f054864a4cacb"
								mask="false"
								optional="false"
								fixedValue="true">
							<from>Description received</from>
							<to>logMessage</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="6dafa827c99740a38ca23baf47264d72"
							lineNumber="106">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="7710e3d76b394090b6daaba91b063389"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>input/input</from>
							<to>logMessage</to>
						</steps>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map"
						comment="Get all state instances, we'll need them very likely"
						disabled="false"
						id="646af6eb0d3b4b60959e084bfec270bc"
						lineNumber="107">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
							disabled="false"
							id="98dd612ac66a4bf6b1954f4e999ced2c"
							serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
							resultName="resultfe86d821158242a4a81b15749e1cbd85"
							temporaryMapping="true"
							x="202"
							y="218"
							invocationOrder="0"
							asynchronous="false"
							recache="false">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="8440cc5ba4b84d5f961259a98d68a7ca"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>createdActions/processStateInstanceId</from>
							<to>filter/id</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="def09f6e39b24aa3a0af9f3359b98126"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>serviceContextConnectionId</from>
							<to>connectionId</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="e518e3e7aaf44dd384e3c03a5100b2a2"
							mask="false"
							optional="false"
							fixedValue="false">
						<from>resultfe86d821158242a4a81b15749e1cbd85/results</from>
						<to>stateInstances</to>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
							disabled="false"
							id="ccc76ffec1684577a606a526aebbfdda"
							serviceId="nabu.utils.Date.now"
							resultName="result8a8b6a1964d340d09eeaf03a0766c536"
							temporaryMapping="true"
							x="193"
							y="348"
							invocationOrder="0"
							asynchronous="false"
							recache="false">
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="d0cad43482c2459587be5e67b6c2d2f8"
							mask="false"
							optional="false"
							fixedValue="false">
						<from>result8a8b6a1964d340d09eeaf03a0766c536/date</from>
						<to>date</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.For"
						disabled="false"
						id="74b5e4f4415f4e6a848d4f7276c0fe49"
						lineNumber="108"
						variable="createdAction">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="2d4aa391eac84f0d8bcf724eacb9644e"
							lineNumber="109">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="50ac2c2c17dd49fa9b65854caef81f6b"
								serviceId="nabu.frameworks.process.crud.processInstanceLog.services.create"
								resultName="result2e2ede2107ef4dc1be8954c19f820e95"
								temporaryMapping="true"
								x="604"
								y="176"
								invocationOrder="1"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="433a883eef524a72946b4a84124000bc"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>createdAction/id</from>
								<to>instance/processActionInstanceId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="7a1da0620fb24e3c90df7c8c75319a37"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>stateInstances[id == /createdAction/processStateInstanceId]/processInstanceId</from>
								<to>instance/processInstanceId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="5c8df653c1a3411c89949d797f30ba8b"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>information</from>
								<to>instance/logType</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="6fab5e7ff6e2464089f07d1ee73d3029"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>logMessage</from>
								<to>instance/log</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="8a61dec133c44d0b881801392a8a7cda"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>logBinding</from>
								<to>instance/dataBinding</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="8e6e2ad1ca4d4a648db5d512d670284d"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>date</from>
								<to>instance/created</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="009248cceee442878568e2577789bdb9"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>serviceContextConnectionId</from>
								<to>connectionId</to>
							</steps>
						</steps>
					</steps>
					<query>createdActions</query>
				</steps>
			</steps>
		</steps>
	</steps>
</sequence>