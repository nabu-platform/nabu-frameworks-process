<sequence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		disabled="false"
		id="8b3b282fff3840bfbd476165d9b65c81"
		lineNumber="1">
	<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
			disabled="false"
			id="98caa3cef5714cdc85f71c0d5b3486c8"
			lineNumber="2"
			query="input/type">
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
				disabled="false"
				id="c3665a4710b14977b359eadf2327cd28"
				label="&quot;SERVICE&quot;"
				lineNumber="3">
			<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
					disabled="false"
					id="6103ae73b0804cd18fdc2d76a43d33c4"
					lineNumber="4"
					query="input/stopped">
				<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
						comment="This is a start log"
						disabled="false"
						id="d208d7f4bb9e4a318535d0a5decf5bc5"
						label="null"
						lineNumber="5"
						scopeDefaultTransaction="true">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="09466aaddf234fd4a23c030d98b54aff"
							lineNumber="6">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="3a95f284e16340c5956c1789608b0ed0"
								serviceId="nabu.frameworks.process.providers.action.service.utils.getActionsToRun"
								resultName="resultf4d0f0c0ce5a4cc48d1cbc83f93d68af"
								temporaryMapping="true"
								x="165"
								y="82"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="b0ba2ac983cb4227b7f8de54dd0f8a87"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>input/name</from>
								<to>serviceId</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="2f8a3e388ff648bd8c083c658007d2e9"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>input/input</from>
								<to>serviceInput</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="23e4c3da356c49b19151482e6b6a561b"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>input/device</from>
								<to>device</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="3bd3894d581c461ebbed20e99393e1e1"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>input/token</from>
								<to>token</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="10c1212edea2410c99e17187e9fe46e2"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>resultf4d0f0c0ce5a4cc48d1cbc83f93d68af/actionsToRun</from>
							<to>actionsToRun</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="5cb6676326cc40f4b9959b81c026b5a6"
								serviceId="nabu.utils.Runtime.getCorrelationId"
								resultName="result71183644ce3d4a8d8d26db10e5fe0521"
								temporaryMapping="true"
								x="233"
								y="255"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="9490a1e195994265a7c9e23074bee75d"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result71183644ce3d4a8d8d26db10e5fe0521/correlationId</from>
							<to>correlationId</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="184e2e75122d4e9984570e2ce592b04f"
								serviceId="nabu.utils.Date.now"
								resultName="result04f0463edd74424996ad484c9aef4276"
								temporaryMapping="true"
								x="166"
								y="382"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="46b21d40be184d3f942921df63c54740"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result04f0463edd74424996ad484c9aef4276/date</from>
							<to>date</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.For"
							disabled="false"
							id="95972818e71b438f9c52e83cf36f4361"
							lineNumber="7"
							variable="actionToRun"
							into="createdActions">
						<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
								disabled="false"
								id="cb05c7ec143f41ccb7c4479c204db9fc"
								lineNumber="8"
								query="actionToRun/newProcessInstance">
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									comment="Automated actions are asynchronously and only committed for running after the root transaction is finished. Should be fine to trigger them on start. Note we don't have captured state yet"
									disabled="false"
									id="cd5bf1d06df247a1a743004c73ef134c"
									label="true"
									lineNumber="9">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="b9fcc7f863614acd96d71245b34a3c67"
										serviceId="nabu.frameworks.process.crud.processStateInstance.services.create"
										resultName="result8bd9004fa2cb475da8fdd4300b5a011d"
										temporaryMapping="true"
										x="693"
										y="239"
										invocationOrder="1"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="fb9517e1c0c44f159b217e8c46a3639d"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processStateId</from>
										<to>instance/processStateId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="1ab430f7ae644104856335bb468391f4"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>date</from>
										<to>instance/started</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="7a96027176b04d12b761e18bcffeaac9"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>result6a10e9d5bc5b49ff98cc2044e4578bcb/instance/id</from>
										<to>instance/processInstanceId</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="57280e2af075495f8ea8090653019b69"
										mask="true"
										optional="false"
										fixedValue="false">
									<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
									<to>stateInstance</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="c23ef97947a5437fa2464f66cc43c1c0"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runStateAutomatic"
										resultName="resulta9724c95b0a944c08e2fb5918f64ef2d"
										temporaryMapping="true"
										x="856"
										y="523"
										invocationOrder="2"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="860ae04322ae4f18a37db9d53c931355"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/name</from>
										<to>serviceId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="d9083f9d3c294f69800bc6e49bd9f4d6"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processActionId</from>
										<to>actionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="650d8262a57e4294aaa4c952c9698794"
											mask="true"
											optional="false"
											fixedValue="false">
										<from>result8bd9004fa2cb475da8fdd4300b5a011d/created</from>
										<to>stateInstance</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="520354366abf4af8bcddd2fdb5e2f3cf"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processVersionId</from>
										<to>processVersionId</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="824b413d8f6d4f1e96ffcad74dfc5888"
										serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.startProcess"
										resultName="result6a10e9d5bc5b49ff98cc2044e4578bcb"
										temporaryMapping="true"
										x="65"
										y="51"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2693c36ea9fc49739fe2249271214061"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processVersionId</from>
										<to>processVersionId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="22f8bf7c17804bb5a8fe693944d80132"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processStateId</from>
										<to>initialStateId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="7af7bb842d814982ba46192afd005056"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/token/authenticationId</from>
										<to>userId</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2e4ede1d08d54b298dd62e5f27ed9443"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>input/device/deviceId</from>
										<to>deviceId</to>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Map"
									disabled="false"
									id="e807219c832e4ce990bf350c70420580"
									lineNumber="10">
								<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
										disabled="false"
										id="a7588f91606d4ceeb5b32f6294fcf3ed"
										serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
										resultName="resultcc0cd201f62045f0825e241020bfd43a"
										temporaryMapping="true"
										x="244"
										y="167"
										invocationOrder="0"
										asynchronous="false"
										recache="false">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="12a5cd1cc76645458c032d2658e8ec28"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processInstanceId</from>
										<to>filter/processInstanceId[0]</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="aee4a542b5864c188d25d83503452726"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>actionToRun/processStateId</from>
										<to>filter/processStateId[0]</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="c4527ac452c04fd2895e38f82bfa9f85"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>true</from>
										<to>filter/running</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="f0bc911da13c4a8b9d174870b8fe3e05"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resultcc0cd201f62045f0825e241020bfd43a/results[0]</from>
									<to>stateInstance</to>
								</steps>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Throw"
								disabled="false"
								id="b95f997efe014c32a73722f06dabfc57"
								label="!stateInstance"
								lineNumber="11"
								code="PROCESS-INCONSISTENT-STATE"
								message="Could not find the the state instance" xsi:nil="true"/>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								id="e270dc19dfe34413ab46799e0cef2429"
								label="actionToRun/reprocessable"
								lineNumber="12">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="f9794efb5841403f9a4acda637abb0a9"
									serviceId="nabu.data.xml.Services.marshal"
									resultName="resultd619440b73c246099cfda315c9864151"
									temporaryMapping="true"
									x="133"
									y="84"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="a0a460ce796240c19b5eaed250636a2e"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/input</from>
									<to>data</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="894613af2a5846ed9628b493a71debbb"
										mask="false"
										optional="false"
										fixedValue="true">
									<from>true</from>
									<to>prettyPrint</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="23387d3246b0486792527d09fb97ff4b"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultd619440b73c246099cfda315c9864151/marshalled</from>
								<to>serializedInput</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								disabled="false"
								id="46b32431bfb44d3491a8bcc9013b6cae"
								lineNumber="13">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="ffb2ea81b10146448458a63dcf9d62ff"
									serviceId="nabu.frameworks.process.crud.processActionInstance.services.create"
									resultName="result6d4a32aa509945bdb6081761dedb93db"
									temporaryMapping="true"
									x="422"
									y="92"
									invocationOrder="1"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="89ebded502ff4be29ec8d207a7a923bf"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>correlationId</from>
									<to>instance/correlationId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="46f7bc7cfa58430a8dd8116975b078d2"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>stateInstance/id</from>
									<to>instance/processStateInstanceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="f6e8594688cd4baab04f8ff317a33390"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>actionToRun/processActionId</from>
									<to>instance/processActionId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="d1e845b3a49242dabc39f4ce79c9c189"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/device/deviceId</from>
									<to>instance/deviceId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="e0e4aa3f89a74140994810c22ae71720"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>input/token/authenticationId</from>
									<to>instance/userId</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="e38c852a8e404d4e9879d51ce6ef006b"
										mask="false"
										optional="false"
										fixedValue="true">
									<from>RUNNING</from>
									<to>instance/processState</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="4d04e135f95443bc8cdfee669bfa6fa1"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>resulte46916ba00174ed3a766f8a96a05fdd9/server</from>
									<to>instance/serverOwner</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="1534d7c881d34526906fba2f4cbbed2c"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>date</from>
									<to>instance/started</to>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="57d99dfaf2ad4b70a6d30bd941e8d2fb"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>serializedInput</from>
									<to>instance/input</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="43c6aa0cdba44422b0bf86a9b480c2c4"
									serviceId="nabu.utils.Server.getServerName"
									resultName="resulte46916ba00174ed3a766f8a96a05fdd9"
									temporaryMapping="true"
									x="70"
									y="213"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="c6bfbbef97f44efcb024942501adcce9"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>result6d4a32aa509945bdb6081761dedb93db/created</from>
								<to>createdActions[0]</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
									disabled="false"
									id="8a173dc5b0354cb28ceb42afdfa311c9"
									path="serializedInput" xsi:nil="true"/>
						</steps>
						<query>actionsToRun</query>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="c7454bac39ff4f23a099aae104cc6720"
							label="createdActions"
							lineNumber="14">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="805498227f834e96a20226d3d0dc9520"
								serviceId="nabu.utils.Runtime.setContext"
								resultName="resultffb6241a460d48f59301ed367ffb3d50"
								temporaryMapping="true"
								x="86"
								y="145"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="1f07b00e225b48219bd91f90585181b4"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>process-action-instances</from>
								<to>key</to>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="92ce9173945846e5b6145dee6b8391e4"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>createdActions</from>
								<to>value</to>
							</steps>
						</steps>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
						comment="This is an end log"
						disabled="false"
						id="6f2534ad05cd40428f01fd6798fda7e7"
						lineNumber="15">
					<steps xsi:type="be.nabu.libs.services.vm.step.Map"
							disabled="false"
							id="c0d28d9ed94f406f824403af579579fe"
							lineNumber="16">
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="845c5f375445405a9ac19f6e1c74c66b"
								serviceId="nabu.utils.Runtime.getContext"
								resultName="resultbeb16ef9c5614ff3a81febdc3b0c8894"
								temporaryMapping="true"
								x="211"
								y="165"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="978bc03e63a346f7845051c6fb433c3a"
									mask="false"
									optional="false"
									fixedValue="true">
								<from>process-action-instances</from>
								<to>key</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="61cce57e32454957b58ef0d4d2018667"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>resultbeb16ef9c5614ff3a81febdc3b0c8894/value</from>
							<to>createdActions</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
								disabled="false"
								id="a65e047d5e0f4a35b01b4a60cf0c2aa4"
								serviceId="nabu.utils.Date.now"
								resultName="result28e0ed9ff94740ec935ca7f9c55bb52e"
								temporaryMapping="true"
								x="229"
								y="275"
								invocationOrder="0"
								asynchronous="false"
								recache="false">
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link"
								disabled="false"
								id="46a2b69a6dc847578cd2712ad3d06509"
								mask="false"
								optional="false"
								fixedValue="false">
							<from>result28e0ed9ff94740ec935ca7f9c55bb52e/date</from>
							<to>date</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
							disabled="false"
							id="a935175a6a6642609f4537b89c7e24f9"
							label="createdActions"
							lineNumber="17">
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								comment="Get all state instances, we'll need them very likely"
								disabled="false"
								id="1aab3d08f4c041b78268d550f2e7b457"
								lineNumber="18">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="a8ef0f33ac2b426d8a6d8160f18a7a8f"
									serviceId="nabu.frameworks.process.crud.processStateInstance.services.list"
									resultName="resultfe86d821158242a4a81b15749e1cbd85"
									temporaryMapping="true"
									x="202"
									y="218"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="0ffadb8ec7414fedaa7608c15d41a523"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>createdActions/processStateInstanceId</from>
									<to>filter/id</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="d634f4880c5143979c62560f1bdabd39"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>resultfe86d821158242a4a81b15749e1cbd85/results</from>
								<to>stateInstances</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Map"
								comment="Get process instances as well"
								disabled="false"
								id="822749cce63c49969106f2abe179fa37"
								label="stateInstances"
								lineNumber="19">
							<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
									disabled="false"
									id="354f818ec0984c26a6c5fa24812aa27a"
									serviceId="nabu.frameworks.process.crud.processInstance.services.list"
									resultName="result46693267717e400e85b763edd859714a"
									temporaryMapping="true"
									x="219"
									y="133"
									invocationOrder="0"
									asynchronous="false"
									recache="false">
								<steps xsi:type="be.nabu.libs.services.vm.step.Link"
										disabled="false"
										id="c2c7259b08944183a0c9cfb0e22576f7"
										mask="false"
										optional="false"
										fixedValue="false">
									<from>stateInstances/processInstanceId</from>
									<to>filter/id</to>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.Link"
									disabled="false"
									id="57e769ff3d18445ea1df53f18f9d8e07"
									mask="false"
									optional="false"
									fixedValue="false">
								<from>result46693267717e400e85b763edd859714a/results</from>
								<to>processInstances</to>
							</steps>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
								disabled="false"
								id="d7dfc72b009040efacf7e6103ac70ccc"
								lineNumber="20"
								query="input/exception">
							<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
									comment="No problem"
									disabled="false"
									id="c41d474a544140539c9b724c54fb824b"
									label="null"
									lineNumber="21">
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Capture all the variables we need"
										disabled="false"
										id="055c7ce56c504436af99054fe7ac9727"
										lineNumber="22">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="2ef370c8234444dc9472dcf5b1751f01"
											serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.getCapturedValues"
											resultName="resultc95bfd86945b4bce888d79bc1267480e"
											temporaryMapping="true"
											x="229"
											y="103"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="488346121cfd4929a0cdd51972bc402a"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/name</from>
											<to>serviceName</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="a60c4079115d4ac386627aab6010c10a"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultc95bfd86945b4bce888d79bc1267480e/capturedValues</from>
										<to>finalCapturedValues</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.For"
										disabled="false"
										id="4c3827bcea0e40669ff64aff016a9c7f"
										lineNumber="23"
										variable="createdAction">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Basic mapping"
											disabled="false"
											id="95d2636edac64c1db67ad877755976b1"
											lineNumber="24">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="72e1339718a44d399eef134506bd224e"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>SUCCEEDED</from>
											<to>createdAction/processState</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="c0a1021cd2a0468c911ed6c2944be18b"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>date</from>
											<to>createdAction/stopped</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											disabled="false"
											id="834cf25a740c4156ba4dd62382e09ba8"
											label="finalCapturedValues"
											lineNumber="25">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="537bf16f947b41cc80c9d90d1e94828b"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.storeCaptured"
												resultName="resulted4c24f32a0945a9bd0142fa74547242"
												temporaryMapping="true"
												x="266"
												y="62"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="179950733f904f2aaf32f9a278981c1b"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>service</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="f1dcb8b6ba984c44850c8be143693532"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>actionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="437045ccc0af46f3b92c9919c5c2363e"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/id</from>
												<to>actionInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="9109a71072f149aa935c92c152cd56ab"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstances[id == /createdAction/processStateInstanceId]/processInstanceId</from>
												<to>processInstanceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="d526133804bb428e94da93a64b490743"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>finalCapturedValues</from>
												<to>capturedValues</to>
											</steps>
										</steps>
									</steps>
									<query>createdActions</query>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="We want to get all data for all processes in one select. This means we need to process all data capturing for actions first. This allows us to calculate conditions"
										disabled="false"
										id="a7572350177d4250bf70ddf260a3220d"
										lineNumber="26">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="ce599abe25e24f8c87028e26cdf14a85"
											serviceId="nabu.frameworks.process.crud.processData.services.list"
											resultName="resultb1890bfb15dc4f909e09b50620e0471a"
											temporaryMapping="true"
											x="160"
											y="54"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="4c44685070334bd29b385687ed2aa55e"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>stateInstances/processInstanceId</from>
											<to>filter/processInstanceId</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="6ec049ee1255440cb8576de4f8d3aa6d"
												mask="false"
												optional="false"
												fixedValue="true">
											<from>true</from>
											<to>filter/active</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="e82f0f1ee1e34ba58273c30a7d302bec"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resultb1890bfb15dc4f909e09b50620e0471a/results</from>
										<to>allData</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.For"
										disabled="false"
										id="63f5371453d54edda9cc652457911d45"
										lineNumber="27"
										variable="createdAction">
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get state instance for action instance"
											disabled="false"
											id="2017d8e76b2443a4aa773a6f2add027f"
											lineNumber="28">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="ca8c2c60a9b24555b1ff43a5cf53781a"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>stateInstances[id == /createdAction/processStateInstanceId]</from>
											<to>stateInstance</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="fbaba2bcde0b410abc30e9fd5b3e47fa"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>allData[processInstanceId == /createdAction/processStateInstanceId]</from>
											<to>applicableData</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Get the process instance"
											disabled="false"
											id="a7b9f26eb7db45e88c8834ddc86496db"
											label="stateInstance"
											lineNumber="29">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="5aa1fc9bd29f484d8ab7fafeefd64034"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>processInstances[id == /stateInstance/processInstanceId]</from>
											<to>processInstance</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="It updates the state instance by reference so we can keep using it"
											disabled="false"
											id="4f4d78a154cb4793887a338b2d40a2a6"
											lineNumber="30">
										<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
												disabled="false"
												id="edfdc5ad1cb14e2887a9b26a7ba00176"
												serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.moveState"
												resultName="resultff74b77b2e0f4212bc352f997d8da552"
												temporaryMapping="true"
												x="257"
												y="143"
												invocationOrder="0"
												asynchronous="false"
												recache="false">
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="3f55640f9a20446fa319ccee24da8207"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>createdAction/processActionId</from>
												<to>actionId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="4ebbb4a736044cb8aed444d1a083ba88"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>input/name</from>
												<to>serviceId</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="8563fb4dafd8453ca63d871a45a3106b"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>stateInstance</from>
												<to>stateInstance</to>
											</steps>
											<steps xsi:type="be.nabu.libs.services.vm.step.Link"
													disabled="false"
													id="f8551396fb7e436f88ce17bee67ef90e"
													mask="false"
													optional="false"
													fixedValue="false">
												<from>applicableData</from>
												<to>processData</to>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="86c6f68856114ad6a7b30f152f7a5417"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>resultff74b77b2e0f4212bc352f997d8da552/movedState</from>
											<to>movedState</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
											disabled="false"
											id="21161fba5cc544bd91b25e64276f2073"
											lineNumber="31">
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												disabled="false"
												id="b4536ee10556494096e71362557c0000"
												label="movedState"
												lineNumber="32">
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="58778105daf44d9c8aa17eeb41d7cf5d"
													serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runStateAutomatic"
													resultName="resultabaa613f908843d9ad970b0fd35f2912"
													temporaryMapping="true"
													x="297"
													y="123"
													invocationOrder="0"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="e2a80497cdc047b0a96cf274a539c2fe"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>input/name</from>
													<to>serviceId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="232dc17535f8488faea9d4a9a1fb9602"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>createdAction/id</from>
													<to>actionId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="09a4fe3c33844adea9dc8d4fd9cd4282"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>stateInstance</from>
													<to>stateInstance</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="d3777e81386249dfa36e8bb4ad099df0"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>applicableData</from>
													<to>processData</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="aa436d5f61af48b99fa044c48b8ff048"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>processInstance/processVersionId</from>
													<to>processVersionId</to>
												</steps>
											</steps>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Map"
												disabled="false"
												id="5d53470c2207478ba1f087b2f0b61db7"
												lineNumber="33">
											<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
													disabled="false"
													id="31a4c44947324e82a24683776875d8bf"
													serviceId="nabu.frameworks.process.providers.action.service.utils.tracker.runActionsAutomatic"
													resultName="result5e83411e114b42109d327f628bcae347"
													temporaryMapping="true"
													x="396"
													y="64"
													invocationOrder="0"
													asynchronous="false"
													recache="false">
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="feac806bb95e48bbb68a877a3daf07a4"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>input/name</from>
													<to>serviceId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="450885f3b0de47dc965e32844ce7ba58"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>stateInstance</from>
													<to>stateInstance</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="7a7737065306453686e59ec0a1259e04"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>applicableData</from>
													<to>processData</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="2c4140720d2d4141a51c9a8af0e14fe7"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>processInstance/processVersionId</from>
													<to>processVersionId</to>
												</steps>
												<steps xsi:type="be.nabu.libs.services.vm.step.Link"
														disabled="false"
														id="e474702c4138464982ed746e32cba464"
														mask="false"
														optional="false"
														fixedValue="false">
													<from>createdAction/processActionId</from>
													<to>actionId</to>
												</steps>
											</steps>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Map"
											comment="Evaluate any/all/finalizer/..."
											disabled="false"
											features="TODO"
											id="84d45a4a34634cfdb37afcff298ffb7b"
											lineNumber="34">
									</steps>
									<query>createdActions</query>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Update the actions"
										disabled="false"
										id="704eb616f52f48268787ac2dd4460bb5"
										lineNumber="35">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="304131f8988942b8b2e5acdc7aa3e03d"
											serviceId="nabu.services.jdbc.Services.update"
											resultName="resulta4491316b050480499905b8d4424bc01"
											temporaryMapping="true"
											x="154"
											y="234"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="78b16f027b444ecf801b8b8af970b1c2"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>createdActions</from>
											<to>instances</to>
										</steps>
									</steps>
								</steps>
							</steps>
							<steps xsi:type="be.nabu.libs.services.vm.step.For"
									comment="Is problem"
									disabled="false"
									id="b546ab82a7c94b6d82218703e540e52c"
									lineNumber="36"
									variable="createdAction">
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Get state instance for action instance"
										disabled="false"
										id="1ff52b7a0caf4fccac18fe8bb85a1492"
										lineNumber="37">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="0a224a195a8548338dff5cde4346ec94"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>stateInstances[id == /createdAction/processStateInstanceId]</from>
										<to>stateInstance</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Get the process instance"
										disabled="false"
										id="be99d08356254678a6bf840ab4b4947b"
										lineNumber="38">
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="2481981fda0a40a38568326e4afe9d57"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>processInstances[id == /stateInstance/processInstanceId]</from>
										<to>runningProcess</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Set the error on the action and process"
										disabled="false"
										id="92b72e331463419793fb1242b5f7d2a0"
										lineNumber="39">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="be5e94e027b84109ad9b29f586336253"
											serviceId="nabu.utils.Runtime.summarizeException"
											resultName="resulted3829100017498b97336741f67c60e1"
											temporaryMapping="true"
											x="108"
											y="137"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="adc9b24df7be4586b2e669e0c377cb5c"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>input/exception</from>
											<to>exception</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="49b65d26c69941baaa2a71f846b7bce3"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>resulted3829100017498b97336741f67c60e1/summary/exceptionStack</from>
										<to>createdAction/error</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="7d980861240c48e58cf0f7fa4f460866"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>ERROR</from>
										<to>createdAction/processState</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="aeac207a51754b5aa6681a0aa464389e"
											mask="false"
											optional="false"
											fixedValue="true">
										<from>ERROR</from>
										<to>runningProcess/processState</to>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Link"
											disabled="false"
											id="3a105c268be94703bf016ded73ea3be5"
											mask="false"
											optional="false"
											fixedValue="false">
										<from>date</from>
										<to>createdAction/stopped</to>
									</steps>
								</steps>
								<steps xsi:type="be.nabu.libs.services.vm.step.Map"
										comment="Update both"
										disabled="false"
										id="5aabe2dbcaa248198b4328deac570001"
										lineNumber="40">
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="b6faec11403949dab5711e3a1e8199f5"
											serviceId="nabu.frameworks.process.crud.processInstance.services.update"
											resultName="result197ba6bbd4e64755bf1f10b0d0e1dd6a"
											temporaryMapping="true"
											x="233"
											y="99"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="2bc339d48ca743689a9d527487b7c0f5"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>runningProcess/id</from>
											<to>id</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="ad282583d33142429ee51507bb600c35"
												mask="true"
												optional="false"
												fixedValue="false">
											<from>runningProcess</from>
											<to>instance</to>
										</steps>
									</steps>
									<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
											disabled="false"
											id="d1d855af348b4097867e05f2d16a2157"
											serviceId="nabu.frameworks.process.crud.processActionInstance.services.update"
											resultName="resultec829bf2c2104b21964acf31cc927965"
											temporaryMapping="true"
											x="248"
											y="276"
											invocationOrder="0"
											asynchronous="false"
											recache="false">
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="627cf73c6707476eb4be12b4841746ee"
												mask="true"
												optional="false"
												fixedValue="false">
											<from>createdAction</from>
											<to>instance</to>
										</steps>
										<steps xsi:type="be.nabu.libs.services.vm.step.Link"
												disabled="false"
												id="53fc73c37c7d4b9c94e6283540de39e8"
												mask="false"
												optional="false"
												fixedValue="false">
											<from>createdAction/id</from>
											<to>id</to>
										</steps>
									</steps>
								</steps>
								<query>createdActions</query>
							</steps>
						</steps>
					</steps>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
				disabled="false"
				id="e0ee9dd4612349a6ab18bbc8573e9653"
				label="&quot;DESCRIPTION&quot;"
				lineNumber="41">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map"
					disabled="false"
					id="f691e4f47bc64a2291c7c816f065c587"
					lineNumber="42">
				<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
						disabled="false"
						id="f74a9369b5a64930a4fa7b4cdb25eff5"
						serviceId="nabu.utils.Runtime.getContext"
						resultName="resultbeb16ef9c5614ff3a81febdc3b0c8894"
						temporaryMapping="true"
						x="211"
						y="165"
						invocationOrder="0"
						asynchronous="false"
						recache="false">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link"
							disabled="false"
							id="9d1a4633d04146c9ae2a568ca58c2f5b"
							mask="false"
							optional="false"
							fixedValue="true">
						<from>process-action-instances</from>
						<to>key</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="8fb8f045f61a44d18d686f77367258ff"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>resultbeb16ef9c5614ff3a81febdc3b0c8894/value</from>
					<to>createdActions</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
					disabled="false"
					id="379b6c5d7de74444bd5837dc4aef608b"
					label="createdActions"
					lineNumber="43">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map"
						comment="Add it to the process instances"
						disabled="false"
						features="TODO"
						id="1038121c59174d7aacceb1469350e59d"
						lineNumber="44">
				</steps>
			</steps>
		</steps>
	</steps>
</sequence>